<?xml version="1.0" encoding="UTF-8"?>

<SQL CP_1_NOM_PIPE_DIAM="CALC(NPD)" CP_2_NOM_PIPE_DIAM="CALC(NPD)" CP_3_NOM_PIPE_DIAM="CALC(NPD)" 
CP_1_END_PREP="CALC(SP_END_PREP)" CP_2_END_PREP="CALC(SP_END_PREP)" CP_3_END_PREP="CALC(SP_END_PREP)">
SELECT DISTINCT 
P112.AREA_NAME,
P113.MODEL_NO,
P34.PIPING_COMP_NO,
ROUND(P34.FACE_TO_FACE_DIM,0),
(P34.CP_1_NOM_PIPE_DIAM-5000)/32,
P34.CP_1_END_PREP,
P34.CP_1_SCH_THK,
P34.CP_1_RATING,
(P34.CP_2_NOM_PIPE_DIAM-5000)/32,
P34.CP_2_END_PREP,
P34.CP_2_SCH_THK,
P34.CP_2_RATING,
(P34.CP_3_NOM_PIPE_DIAM-5000)/32,
P34.CP_3_END_PREP,
P34.CP_3_SCH_THK,
P34.CP_3_RATING,
P12.LINE_NUMBER_LABEL,
P12.LINE_ID 
FROM 
MTO_{PROJECTNAME}.PDTABLE_34 P34,
MTO_{PROJECTNAME}.PDTABLE_12 P12,
PD_{PROJECTNAME}.PDTABLE_112 P112,
PD_{PROJECTNAME}.PDTABLE_113 P113 
WHERE 
P34.CP1_IDX_12=P12.SYSTEM_UNIQUE_NO AND 
P12.PARTITION_NO=P113.PARTITION_NO AND 
P112.AREA_INDEX_NO=P113.AREA_INDEX_NO AND 
P112.DISCIPLINE_INDX_NO=1 AND 
P34.PIPING_COMP_NO IS NOT NULL AND 
P34.PIPING_COMP_NO LIKE 'SP%'
ORDER BY 
P112.AREA_NAME,
P113.MODEL_NO
</SQL>