<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=KS_C_5601-1987">
<title>E:\PROJECT\9SQ\Projects\HANWHA\IsoManPlus\IssueManager\IssueManager\IssueManager.cs.html</title>
<meta name="Generator" content="Vim/7.3">
<meta name="plugin-version" content="vim7.3_v6">
<meta name="syntax" content="cs">
<meta name="settings" content="use_css,number_lines">
<style type="text/css">
<!--
pre { font-family: monospace; color: #c0c0c0; background-color: #000040; }
body { font-family: monospace; color: #c0c0c0; background-color: #000040; }
.lnr { color: #90f020; }
.Special { color: #ffa500; }
.Identifier { color: #40ffff; }
.Constant { color: #ffa0a0; }
.Type { color: #60ff60; }
.Comment { color: #80a0ff; }
.Statement { color: #ffff60; }
-->
</style>
</head>
<body>
<pre>
<span class="lnr">   1 </span><span class="Statement">using</span> System;
<span class="lnr">   2 </span><span class="Statement">using</span> System.Collections.Generic;
<span class="lnr">   3 </span><span class="Statement">using</span> System.ComponentModel;
<span class="lnr">   4 </span><span class="Statement">using</span> System.Data;
<span class="lnr">   5 </span><span class="Statement">using</span> System.Drawing;
<span class="lnr">   6 </span><span class="Statement">using</span> System.Linq;
<span class="lnr">   7 </span><span class="Statement">using</span> System.Text;
<span class="lnr">   8 </span><span class="Statement">using</span> System.Windows.Forms;
<span class="lnr">   9 </span><span class="Statement">using</span> System.Data.OleDb;
<span class="lnr">  10 </span><span class="Statement">using</span> System.IO; <span class="Comment">// Add</span>
<span class="lnr">  11 </span><span class="Statement">using</span> System.Reflection;
<span class="lnr">  12 </span>
<span class="lnr">  13 </span><span class="Type">namespace</span> IsoManPlus
<span class="lnr">  14 </span>{
<span class="lnr">  15 </span>        <span class="Type">public</span> <span class="Statement">partial</span> <span class="Type">class</span> IssueManager : Form
<span class="lnr">  16 </span>        {
<span class="lnr">  17 </span>                <span class="Type">private</span> ADODB.Connection m_connection = <span class="Statement">new</span> ADODB.Connection();
<span class="lnr">  18 </span>                <span class="Type">private</span> ADODB.Recordset m_recordset = <span class="Statement">new</span> ADODB.Recordset();
<span class="lnr">  19 </span>                <span class="Type">private</span> BindingSource bindingSource1 = <span class="Statement">new</span> BindingSource();
<span class="lnr">  20 </span>                <span class="Type">private</span> OleDbDataAdapter m_dataAdapter = <span class="Statement">new</span> OleDbDataAdapter();
<span class="lnr">  21 </span>                DataTable m_table = <span class="Statement">new</span> DataTable();
<span class="lnr">  22 </span>
<span class="lnr">  23 </span>                <span class="Type">private</span> Ini m_oIni = <span class="Statement">new</span> Ini();
<span class="lnr">  24 </span>
<span class="lnr">  25 </span>                <span class="Type">private</span> <span class="Type">int</span> m_iCurRowIndex = -<span class="Constant">1</span>;
<span class="lnr">  26 </span>
<span class="lnr">  27 </span>                <span class="Comment">///</span><span class="Comment"> </span><span class="Identifier">&lt;</span><span class="Statement">summary</span><span class="Identifier">&gt;</span>
<span class="lnr">  28 </span>                <span class="Comment">///</span><span class="Comment"> </span>
<span class="lnr">  29 </span>                <span class="Comment">///</span><span class="Comment"> </span><span class="Identifier">&lt;/</span><span class="Statement">summary</span><span class="Identifier">&gt;</span>
<span class="lnr">  30 </span>                <span class="Type">private</span> CBusinessLogic m_oBusinessLogic = <span class="Statement">new</span> CBusinessLogic();
<span class="lnr">  31 </span>                <span class="Type">public</span> CBusinessLogic BusinessLogic
<span class="lnr">  32 </span>                {
<span class="lnr">  33 </span>                        <span class="Statement">get</span> { <span class="Statement">return</span> m_oBusinessLogic; }
<span class="lnr">  34 </span>                }
<span class="lnr">  35 </span>
<span class="lnr">  36 </span>                <span class="Type">private</span> <span class="Type">int</span> ITEM_COUNT_PER_SHEET = <span class="Constant">60</span>;
<span class="lnr">  37 </span>                <span class="Type">private</span> <span class="Type">int</span> ITEM_HALF_COUNT_PER_SHEET = <span class="Constant">30</span>;
<span class="lnr">  38 </span>
<span class="lnr">  39 </span>                <span class="Type">string</span> AppPath = Application.ExecutablePath.Substring(<span class="Constant">0</span>, Application.ExecutablePath.LastIndexOf(<span class="Constant">&quot;</span><span class="Special">\\</span><span class="Constant">&quot;</span>));
<span class="lnr">  40 </span>
<span class="lnr">  41 </span>                <span class="Comment">///</span><span class="Comment"> </span><span class="Identifier">&lt;</span><span class="Statement">summary</span><span class="Identifier">&gt;</span>
<span class="lnr">  42 </span>                <span class="Comment">///</span><span class="Comment"> </span>
<span class="lnr">  43 </span>                <span class="Comment">///</span><span class="Comment"> </span><span class="Identifier">&lt;/</span><span class="Statement">summary</span><span class="Identifier">&gt;</span>
<span class="lnr">  44 </span>                <span class="Comment">///</span><span class="Comment"> </span><span class="Identifier">&lt;</span><span class="Statement">param</span><span class="Identifier"> </span><span class="Type">name</span>=<span class="Constant">&quot;title&quot;</span><span class="Identifier">&gt;</span><span class="Identifier">&lt;/</span><span class="Statement">param</span><span class="Identifier">&gt;</span>
<span class="lnr">  45 </span>                <span class="Comment">///</span><span class="Comment"> </span><span class="Identifier">&lt;</span><span class="Statement">param</span><span class="Identifier"> </span><span class="Type">name</span>=<span class="Constant">&quot;sDatabaseFilePath&quot;</span><span class="Identifier">&gt;</span><span class="Identifier">&lt;/</span><span class="Statement">param</span><span class="Identifier">&gt;</span>
<span class="lnr">  46 </span>                <span class="Type">public</span> IssueManager(<span class="Type">string</span> sProjectNo, <span class="Type">string</span> sProjectPath)
<span class="lnr">  47 </span>                {
<span class="lnr">  48 </span>                        InitializeComponent();
<span class="lnr">  49 </span>
<span class="lnr">  50 </span>                        <span class="Comment">//2011.2.22 added by KM</span>
<span class="lnr">  51 </span>                        lvwGRADE.Columns.Add(<span class="Constant">&quot;Grade&quot;</span>);
<span class="lnr">  52 </span>                        lvwGRADE.Columns.Add(<span class="Constant">&quot;Desc.&quot;</span>);
<span class="lnr">  53 </span>                        lvwGRADE.Columns[<span class="Constant">0</span>].Width = <span class="Constant">90</span>;
<span class="lnr">  54 </span>                        lvwGRADE.Columns[<span class="Constant">1</span>].Width = <span class="Constant">180</span>;
<span class="lnr">  55 </span>                        lvwREV.Columns.Add(<span class="Constant">&quot;Rev No.&quot;</span>);
<span class="lnr">  56 </span>                        lvwREV.Columns[<span class="Constant">0</span>].Width = <span class="Constant">270</span>;
<span class="lnr">  57 </span>
<span class="lnr">  58 </span>
<span class="lnr">  59 </span>                        listISSUE_DATE.Columns.Add(<span class="Constant">&quot;Date&quot;</span>);
<span class="lnr">  60 </span>                        listView_GRADE.Columns.Add(<span class="Constant">&quot;Grade&quot;</span>);
<span class="lnr">  61 </span>                        listView_GRADE.Columns.Add(<span class="Constant">&quot;Desc.&quot;</span>);
<span class="lnr">  62 </span>                        listView_GRADE.Columns[<span class="Constant">0</span>].Width = <span class="Constant">50</span>;
<span class="lnr">  63 </span>                        listView_GRADE.Columns[<span class="Constant">1</span>].Width = <span class="Constant">100</span>;
<span class="lnr">  64 </span>                        listView_ISSUE_DATE.Columns.Add(<span class="Constant">&quot;Date&quot;</span>);
<span class="lnr">  65 </span>                        listView_ISSUE_DATE.Columns.Add(<span class="Constant">&quot;Control Date&quot;</span>);
<span class="lnr">  66 </span>                        listView_ISSUE_DATE.Columns[<span class="Constant">0</span>].Width = <span class="Constant">100</span>;
<span class="lnr">  67 </span>                        listView_ISSUE_DATE.Columns[<span class="Constant">1</span>].Width = <span class="Constant">100</span>;
<span class="lnr">  68 </span>
<span class="lnr">  69 </span>                        <span class="Statement">this</span>.Text = sProjectNo;
<span class="lnr">  70 </span>                        BusinessLogic.DatabasePath = sProjectPath + <span class="Special">@</span><span class="Constant">&quot;\Database\&quot;</span> + sProjectNo + <span class="Constant">&quot;.mdb&quot;</span>;
<span class="lnr">  71 </span>                        BusinessLogic.IniFilePath = sProjectPath + <span class="Special">@</span><span class="Constant">&quot;\Setting\&quot;</span> + sProjectNo + <span class="Constant">&quot;.ini&quot;</span>;
<span class="lnr">  72 </span>                }
<span class="lnr">  73 </span>
<span class="lnr">  74 </span>                <span class="Comment">///</span><span class="Comment"> </span><span class="Identifier">&lt;</span><span class="Statement">summary</span><span class="Identifier">&gt;</span>
<span class="lnr">  75 </span>                <span class="Comment">///</span><span class="Comment"> get dataset from database</span>
<span class="lnr">  76 </span>                <span class="Comment">///</span><span class="Comment"> </span><span class="Identifier">&lt;/</span><span class="Statement">summary</span><span class="Identifier">&gt;</span>
<span class="lnr">  77 </span>                <span class="Comment">///</span><span class="Comment"> </span><span class="Identifier">&lt;</span><span class="Statement">param</span><span class="Identifier"> </span><span class="Type">name</span>=<span class="Constant">&quot;selectCommand&quot;</span><span class="Identifier">&gt;</span><span class="Identifier">&lt;/</span><span class="Statement">param</span><span class="Identifier">&gt;</span>
<span class="lnr">  78 </span>                <span class="Type">private</span> <span class="Type">void</span> GetDataSetFrom(<span class="Type">string</span> selectCommand , <span class="Type">bool</span> bAddCancellation)
<span class="lnr">  79 </span>                {
<span class="lnr">  80 </span>                        <span class="Statement">try</span>
<span class="lnr">  81 </span>                        {
<span class="lnr">  82 </span>                                <span class="Comment">// Specify a connection string. Replace the given value with a </span>
<span class="lnr">  83 </span>                                <span class="Comment">// valid connection string for a Northwind SQL Server sample</span>
<span class="lnr">  84 </span>                                <span class="Comment">// database accessible to your system.</span>
<span class="lnr">  85 </span>                                <span class="Type">string</span> sConnection = <span class="Constant">&quot;Provider=Microsoft.Jet.OLEDB.4.0;Data Source=&quot;</span> + BusinessLogic.DatabasePath;
<span class="lnr">  86 </span>                                <span class="Comment">///</span><span class="Comment">String connectionString </span>=
<span class="lnr">  87 </span>                                <span class="Comment">///</span><span class="Comment"> &quot;Integrated Security</span>=<span class="Comment">SSPI;Persist Security Info</span>=<span class="Comment">False;&quot; +</span>
<span class="lnr">  88 </span>                                <span class="Comment">///</span><span class="Comment">&quot;Initial Catalog</span>=<span class="Comment">Northwind;Data Source</span>=<span class="Comment">localhost&quot;;</span>
<span class="lnr">  89 </span>
<span class="lnr">  90 </span>                                <span class="Comment">// Create a new data adapter based on the specified query.</span>
<span class="lnr">  91 </span>                                m_dataAdapter = <span class="Statement">new</span> OleDbDataAdapter(selectCommand, sConnection);
<span class="lnr">  92 </span>
<span class="lnr">  93 </span>                                <span class="Comment">// Create a command builder to generate SQL update, insert, and</span>
<span class="lnr">  94 </span>                                <span class="Comment">// delete commands based on selectCommand. These are used to</span>
<span class="lnr">  95 </span>                                <span class="Comment">// update the database.</span>
<span class="lnr">  96 </span>                                OleDbCommandBuilder commandBuilder = <span class="Statement">new</span> OleDbCommandBuilder(m_dataAdapter);
<span class="lnr">  97 </span>
<span class="lnr">  98 </span>                                <span class="Comment">// Populate a new data table and bind it to the BindingSource.</span>
<span class="lnr">  99 </span>                                m_table = <span class="Statement">new</span> DataTable();
<span class="lnr"> 100 </span>                                m_table.Locale = System.Globalization.CultureInfo.InvariantCulture;
<span class="lnr"> 101 </span>                                <span class="Statement">if</span> (<span class="Constant">true</span> == bAddCancellation)
<span class="lnr"> 102 </span>                                {
<span class="lnr"> 103 </span>                                        DataColumn oColumn = m_table.Columns.Add(<span class="Constant">&quot;C_CANCELLATION&quot;</span>, <span class="Statement">typeof</span>(System.Boolean));
<span class="lnr"> 104 </span>                                }
<span class="lnr"> 105 </span>                                m_dataAdapter.Fill(m_table);
<span class="lnr"> 106 </span>                        }
<span class="lnr"> 107 </span>                        <span class="Statement">catch</span> (OleDbException)
<span class="lnr"> 108 </span>                        {
<span class="lnr"> 109 </span>                                MessageBox.Show(<span class="Constant">&quot;To run this example, replace the value of the &quot;</span> +
<span class="lnr"> 110 </span>                                    <span class="Constant">&quot;connectionString variable with a connection string that is &quot;</span> +
<span class="lnr"> 111 </span>                                    <span class="Constant">&quot;valid for your system.&quot;</span>);
<span class="lnr"> 112 </span>                        }
<span class="lnr"> 113 </span>                }
<span class="lnr"> 114 </span>
<span class="lnr"> 115 </span>                <span class="Comment">/*</span>
<span class="lnr"> 116 </span><span class="Comment">                        @brief  fill data</span>
<span class="lnr"> 117 </span><span class="Comment">                        </span>
<span class="lnr"> 118 </span><span class="Comment">                 *      @author HumKyung</span>
<span class="lnr"> 119 </span><span class="Comment">                 *      </span>
<span class="lnr"> 120 </span><span class="Comment">                 *      @date   2011.02.15</span>
<span class="lnr"> 121 </span><span class="Comment">                 *      </span>
<span class="lnr"> 122 </span><span class="Comment">                 *      @param  sender</span>
<span class="lnr"> 123 </span><span class="Comment">                 *      @param  e</span>
<span class="lnr"> 124 </span><span class="Comment">                 *      </span>
<span class="lnr"> 125 </span><span class="Comment">                 *      @return</span>
<span class="lnr"> 126 </span><span class="Comment">                 */</span>
<span class="lnr"> 127 </span>                <span class="Type">private</span> <span class="Type">void</span> IssueManager_Load(<span class="Type">object</span> sender, EventArgs e)
<span class="lnr"> 128 </span>                {
<span class="lnr"> 129 </span>                        <span class="Statement">this</span>.WindowState = FormWindowState.Maximized;
<span class="lnr"> 130 </span>
<span class="lnr"> 131 </span>                        <span class="Type">string</span> sQuery = <span class="Type">string</span>.Empty;
<span class="lnr"> 132 </span>
<span class="lnr"> 133 </span>                        listPLANT.Items.Add(<span class="Constant">&quot;[all]&quot;</span>);
<span class="lnr"> 134 </span>                        listAREA.Items.Add(<span class="Constant">&quot;[all]&quot;</span>);
<span class="lnr"> 135 </span>                        listUNIT.Items.Add(<span class="Constant">&quot;[all]&quot;</span>);
<span class="lnr"> 136 </span>                        listSECTION.Items.Add(<span class="Constant">&quot;[all]&quot;</span>);
<span class="lnr"> 137 </span>                        GetDataSetFrom(<span class="Constant">&quot;SELECT DISTINCT C_PLANT_NO,C_AREA_NO,C_UNIT_NO,C_SECTION_NO FROM T_ISSUED_LINE_DATA&quot;</span> , <span class="Constant">false</span>);
<span class="lnr"> 138 </span>                        <span class="Statement">foreach</span> (DataRow dr <span class="Statement">in</span> m_table.Rows)
<span class="lnr"> 139 </span>                        {
<span class="lnr"> 140 </span>                                listPLANT.Items.Add(dr[<span class="Constant">0</span>]);
<span class="lnr"> 141 </span>                                listAREA.Items.Add(dr[<span class="Constant">1</span>]);
<span class="lnr"> 142 </span>                                listUNIT.Items.Add(dr[<span class="Constant">2</span>]);
<span class="lnr"> 143 </span>                                listSECTION.Items.Add(dr[<span class="Constant">3</span>]);
<span class="lnr"> 144 </span>                        }
<span class="lnr"> 145 </span>
<span class="lnr"> 146 </span>                        <span class="Comment">//2011.2.22 added by KM</span>
<span class="lnr"> 147 </span>                        GetDataSetFrom(<span class="Constant">&quot;SELECT C_GRADE_PREFIX,C_GRADE_DESC FROM T_GRADE_DEFINE&quot;</span> , <span class="Constant">false</span>);
<span class="lnr"> 148 </span>                        <span class="Statement">foreach</span> (DataRow dr <span class="Statement">in</span> m_table.Rows)
<span class="lnr"> 149 </span>                        {
<span class="lnr"> 150 </span>                                lvwGRADE.Items.Add(dr[<span class="Constant">0</span>].ToString()).SubItems.Add(dr[<span class="Constant">1</span>].ToString());
<span class="lnr"> 151 </span>                        }
<span class="lnr"> 152 </span>
<span class="lnr"> 153 </span>                        <span class="Comment">//2011.2.22 added by KM</span>
<span class="lnr"> 154 </span>                        GetDataSetFrom(<span class="Constant">&quot;SELECT DISTINCT C_REV_NO FROM T_ISSUED_REVISION&quot;</span>, <span class="Constant">false</span>);
<span class="lnr"> 155 </span>                        <span class="Statement">foreach</span> (DataRow dr <span class="Statement">in</span> m_table.Rows)
<span class="lnr"> 156 </span>                        {
<span class="lnr"> 157 </span>                                ListViewItem oLVItem = lvwREV.Items.Add(dr[<span class="Constant">0</span>].ToString());
<span class="lnr"> 158 </span>                                <span class="Statement">if</span> (<span class="Constant">null</span> != oLVItem)
<span class="lnr"> 159 </span>                                {
<span class="lnr"> 160 </span>                                        oLVItem.Tag = dr[<span class="Constant">0</span>].ToString();
<span class="lnr"> 161 </span>                                }
<span class="lnr"> 162 </span>                        }
<span class="lnr"> 163 </span>
<span class="lnr"> 164 </span>                        GetDataSetFrom(<span class="Constant">&quot;SELECT DISTINCT C_ISSUE_DATE FROM T_ISSUE_DATE&quot;</span>, <span class="Constant">false</span>);
<span class="lnr"> 165 </span>                        <span class="Statement">foreach</span> (DataRow dr <span class="Statement">in</span> m_table.Rows)
<span class="lnr"> 166 </span>                        {
<span class="lnr"> 167 </span>                                listISSUE_DATE.Items.Add(dr[<span class="Constant">0</span>].ToString());
<span class="lnr"> 168 </span>                        }
<span class="lnr"> 169 </span>
<span class="lnr"> 170 </span>                        <span class="Comment">//! get revision no from T_ISSUED_REVISION table</span>
<span class="lnr"> 171 </span>                        List&lt;<span class="Type">string</span>&gt; RevNoList = <span class="Statement">new</span> List&lt;<span class="Type">string</span>&gt; { };
<span class="lnr"> 172 </span>                        GetDataSetFrom(<span class="Constant">&quot;SELECT DISTINCT C_REV_NO FROM T_ISSUED_REVISION&quot;</span>, <span class="Constant">false</span>);
<span class="lnr"> 173 </span>                        <span class="Statement">foreach</span> (DataRow dr <span class="Statement">in</span> m_table.Rows)
<span class="lnr"> 174 </span>                        {
<span class="lnr"> 175 </span>                                RevNoList.Add(dr[<span class="Constant">0</span>].ToString());
<span class="lnr"> 176 </span>                        }
<span class="lnr"> 177 </span>
<span class="lnr"> 178 </span>                        comboBox_REVISION_OPTION.Items.Add(<span class="Constant">&quot;LATEST&quot;</span>);
<span class="lnr"> 179 </span>                        <span class="Statement">foreach</span> (<span class="Type">string</span> s <span class="Statement">in</span> RevNoList)
<span class="lnr"> 180 </span>                        {
<span class="lnr"> 181 </span>                                sQuery = <span class="Constant">&quot;SELECT DISTINCT C_FROM_GRADE_DEFINE,C_REVISION_TEXT FROM T_REVISION_STAGE WHERE C_REVISION_NO=&quot;</span> + s;
<span class="lnr"> 182 </span>                                GetDataSetFrom(sQuery , <span class="Constant">false</span>);
<span class="lnr"> 183 </span>                                <span class="Statement">foreach</span> (DataRow dr <span class="Statement">in</span> m_table.Rows)
<span class="lnr"> 184 </span>                                {
<span class="lnr"> 185 </span>                                        <span class="Type">string</span> sRevNo = dr[<span class="Constant">0</span>].ToString() + dr[<span class="Constant">1</span>].ToString();
<span class="lnr"> 186 </span>                                        comboBox_REVISION_OPTION.Items.Add(sRevNo);
<span class="lnr"> 187 </span>                                }
<span class="lnr"> 188 </span>                        }
<span class="lnr"> 189 </span>
<span class="lnr"> 190 </span>                        listISSUE_DATE.Columns[<span class="Constant">0</span>].Width = <span class="Constant">200</span>;
<span class="lnr"> 191 </span>                        comboBox_REVISION_OPTION.SelectedIndex = <span class="Constant">0</span>;
<span class="lnr"> 192 </span>                        listISSUE_DATE.Enabled = checkBox_ISSUE_DATE.Checked;
<span class="lnr"> 193 </span>                        lvwGRADE.Enabled = chkGrade.Checked;
<span class="lnr"> 194 </span>                        lvwREV.Enabled = chkREV.Checked;
<span class="lnr"> 195 </span>                        comboBox_REVISION_OPTION.Enabled = checkBox_ISSUE_DATE.Checked;
<span class="lnr"> 196 </span>                        <span class="Statement">if</span> (chkGrade.Checked &amp;&amp; chkREV.Checked &amp;&amp; checkBox_ISSUE_DATE.Checked)
<span class="lnr"> 197 </span>                        {
<span class="lnr"> 198 </span>                                chkALL.Enabled = <span class="Constant">true</span>;
<span class="lnr"> 199 </span>                        }
<span class="lnr"> 200 </span>                        <span class="Statement">else</span>
<span class="lnr"> 201 </span>                        {
<span class="lnr"> 202 </span>                                chkALL.Enabled = <span class="Constant">false</span>;
<span class="lnr"> 203 </span>                        }
<span class="lnr"> 204 </span>
<span class="lnr"> 205 </span>                        GetDataSetFrom(<span class="Constant">&quot;SELECT C_GRADE_PREFIX,C_GRADE_DESC FROM T_GRADE_DEFINE&quot;</span>, <span class="Constant">false</span>);
<span class="lnr"> 206 </span>                        <span class="Statement">foreach</span> (DataRow dr <span class="Statement">in</span> m_table.Rows)
<span class="lnr"> 207 </span>                        {
<span class="lnr"> 208 </span>                                listView_GRADE.Items.Add(dr[<span class="Constant">0</span>].ToString()).SubItems.Add(dr[<span class="Constant">1</span>].ToString());
<span class="lnr"> 209 </span>                        }
<span class="lnr"> 210 </span>
<span class="lnr"> 211 </span>                        GetDataSetFrom(<span class="Constant">&quot;SELECT C_ISSUE_DATE,C_REAL_ISSUE_DATE FROM T_ISSUE_DATE&quot;</span>, <span class="Constant">false</span>);
<span class="lnr"> 212 </span>                        <span class="Statement">foreach</span> (DataRow dr <span class="Statement">in</span> m_table.Rows)
<span class="lnr"> 213 </span>                        {
<span class="lnr"> 214 </span>                                listView_ISSUE_DATE.Items.Add(dr[<span class="Constant">0</span>].ToString()).SubItems.Add(dr[<span class="Constant">1</span>].ToString());
<span class="lnr"> 215 </span>                        }
<span class="lnr"> 216 </span>
<span class="lnr"> 217 </span>                        <span class="Comment">//! 2011.02.19 added by HumKyung</span>
<span class="lnr"> 218 </span>                        GetDataSetFrom(<span class="Constant">&quot;SELECT C_REVISION_NO,C_FROM_GRADE_DEFINE,C_REVISION_TEXT FROM T_REVISION_STAGE&quot;</span>, <span class="Constant">false</span>);
<span class="lnr"> 219 </span>                        <span class="Statement">foreach</span> (DataRow dr <span class="Statement">in</span> m_table.Rows)
<span class="lnr"> 220 </span>                        {
<span class="lnr"> 221 </span>                                RevisionStage stage = <span class="Statement">new</span> RevisionStage();
<span class="lnr"> 222 </span>                                stage.m_lNo = Convert.ToInt32(dr[<span class="Constant">0</span>].ToString());
<span class="lnr"> 223 </span>                                stage.m_sDefine = dr[<span class="Constant">1</span>].ToString();
<span class="lnr"> 224 </span>                                stage.m_sText = dr[<span class="Constant">2</span>].ToString();
<span class="lnr"> 225 </span>
<span class="lnr"> 226 </span>                                BusinessLogic.m_RevisionStageList.Add(stage);
<span class="lnr"> 227 </span>                        }
<span class="lnr"> 228 </span>
<span class="lnr"> 229 </span>                        GetDataSetFrom(<span class="Constant">&quot;SELECT C_REV_DRWN_BY,C_REV_CHECKED_BY,C_REV_APPROVED_BY FROM T_PROJECT_SETTING&quot;</span>, <span class="Constant">false</span>);
<span class="lnr"> 230 </span>                        <span class="Statement">foreach</span> (DataRow dr <span class="Statement">in</span> m_table.Rows)
<span class="lnr"> 231 </span>                        {
<span class="lnr"> 232 </span>                                BusinessLogic.m_sDrwnBy = dr[<span class="Constant">0</span>].ToString();
<span class="lnr"> 233 </span>                                BusinessLogic.m_sCheckedBy = dr[<span class="Constant">1</span>].ToString();
<span class="lnr"> 234 </span>                                BusinessLogic.m_sApprovedBy = dr[<span class="Constant">2</span>].ToString();
<span class="lnr"> 235 </span>                        }
<span class="lnr"> 236 </span>                }
<span class="lnr"> 237 </span>
<span class="lnr"> 238 </span>                <span class="Comment">/*</span>
<span class="lnr"> 239 </span><span class="Comment">                 *      @brief  query issued table with condition</span>
<span class="lnr"> 240 </span><span class="Comment">                 *      </span>
<span class="lnr"> 241 </span><span class="Comment">                 *      @author HumKyung</span>
<span class="lnr"> 242 </span><span class="Comment">                 *      </span>
<span class="lnr"> 243 </span><span class="Comment">                 *      @date   2011.02.15</span>
<span class="lnr"> 244 </span><span class="Comment">                 *      </span>
<span class="lnr"> 245 </span><span class="Comment">                 *      @param  listbox</span>
<span class="lnr"> 246 </span><span class="Comment">                 *      @param  iSel</span>
<span class="lnr"> 247 </span><span class="Comment">                 *      </span>
<span class="lnr"> 248 </span><span class="Comment">                 *      @return</span>
<span class="lnr"> 249 </span><span class="Comment">                 */</span>
<span class="lnr"> 250 </span>                <span class="Type">private</span> <span class="Type">void</span> btnQuery_Click(<span class="Type">object</span> sender, EventArgs e)
<span class="lnr"> 251 </span>                {
<span class="lnr"> 252 </span>                        <span class="Type">string</span> sQuery = <span class="Constant">&quot;SELECT * FROM T_ISSUED_LINE_DATA&quot;</span>;
<span class="lnr"> 253 </span>
<span class="lnr"> 254 </span>                        <span class="Type">string</span> sSelPlantNo = GetSelItemText(<span class="Statement">ref</span> listPLANT);
<span class="lnr"> 255 </span>                        <span class="Type">string</span> sSelAreaNo = GetSelItemText(<span class="Statement">ref</span> listAREA);
<span class="lnr"> 256 </span>                        <span class="Type">string</span> sSelUnitNo = GetSelItemText(<span class="Statement">ref</span> listUNIT);
<span class="lnr"> 257 </span>                        <span class="Type">string</span> sSelSectionNo = GetSelItemText(<span class="Statement">ref</span> listSECTION);
<span class="lnr"> 258 </span>
<span class="lnr"> 259 </span>                        <span class="Statement">if</span> (((<span class="Type">string</span>.Empty != sSelPlantNo) &amp;&amp; (<span class="Constant">&quot;ALL&quot;</span> != sSelPlantNo)) ||
<span class="lnr"> 260 </span>                                ((<span class="Type">string</span>.Empty != sSelAreaNo) &amp;&amp; (<span class="Constant">&quot;ALL&quot;</span> != sSelAreaNo)) ||
<span class="lnr"> 261 </span>                                ((<span class="Type">string</span>.Empty != sSelUnitNo) &amp;&amp; (<span class="Constant">&quot;ALL&quot;</span> != sSelUnitNo)) ||
<span class="lnr"> 262 </span>                                ((<span class="Type">string</span>.Empty != sSelSectionNo) &amp;&amp; (<span class="Constant">&quot;ALL&quot;</span> != sSelSectionNo)))
<span class="lnr"> 263 </span>                        {
<span class="lnr"> 264 </span>                                sQuery += <span class="Constant">&quot; WHERE&quot;</span>;
<span class="lnr"> 265 </span>                        }
<span class="lnr"> 266 </span>
<span class="lnr"> 267 </span>                        <span class="Statement">if</span> ((<span class="Type">string</span>.Empty != sSelPlantNo) &amp;&amp; (<span class="Constant">&quot;ALL&quot;</span> != sSelPlantNo))
<span class="lnr"> 268 </span>                        {
<span class="lnr"> 269 </span>                                sQuery += <span class="Constant">&quot; C_PLANT_NO IN (&quot;</span> + sSelPlantNo + <span class="Constant">&quot;) AND&quot;</span>;
<span class="lnr"> 270 </span>                        }
<span class="lnr"> 271 </span>                        <span class="Statement">if</span> ((<span class="Type">string</span>.Empty != sSelAreaNo) &amp;&amp; (<span class="Constant">&quot;ALL&quot;</span> != sSelAreaNo))
<span class="lnr"> 272 </span>                        {
<span class="lnr"> 273 </span>                                sQuery += <span class="Constant">&quot; C_AREA_NO IN (&quot;</span> + sSelAreaNo + <span class="Constant">&quot;) AND&quot;</span>;
<span class="lnr"> 274 </span>                        }
<span class="lnr"> 275 </span>                        <span class="Statement">if</span> ((<span class="Type">string</span>.Empty != sSelUnitNo) &amp;&amp; (<span class="Constant">&quot;ALL&quot;</span> != sSelUnitNo))
<span class="lnr"> 276 </span>                        {
<span class="lnr"> 277 </span>                                sQuery += <span class="Constant">&quot; C_UNIT_NO IN (&quot;</span> + sSelUnitNo + <span class="Constant">&quot;) AND&quot;</span>;
<span class="lnr"> 278 </span>                        }
<span class="lnr"> 279 </span>                        <span class="Statement">if</span> ((<span class="Type">string</span>.Empty != sSelSectionNo) &amp;&amp; (<span class="Constant">&quot;ALL&quot;</span> != sSelSectionNo))
<span class="lnr"> 280 </span>                        {
<span class="lnr"> 281 </span>                                sQuery += <span class="Constant">&quot; C_SECTION_NO IN (&quot;</span> + sSelSectionNo + <span class="Constant">&quot;) AND&quot;</span>;
<span class="lnr"> 282 </span>                        }
<span class="lnr"> 283 </span>
<span class="lnr"> 284 </span>                        <span class="Type">string</span> sIssueDate = GetSelectedIssueDate();
<span class="lnr"> 285 </span>                        <span class="Type">string</span> sGrade = GetSelected_Grade();
<span class="lnr"> 286 </span>                        <span class="Statement">if</span> (<span class="Type">string</span>.Empty != sGrade) sGrade = ((Convert.ToInt32(sGrade)) * <span class="Constant">100</span>).ToString();      <span class="Comment">//! 2011.02.24 added by HumKyung</span>
<span class="lnr"> 287 </span>                        <span class="Type">string</span> sRevNo = GetSelected_RevNo();
<span class="lnr"> 288 </span>
<span class="lnr"> 289 </span>                        <span class="Statement">if</span> (<span class="Type">string</span>.Empty != sIssueDate || <span class="Type">string</span>.Empty != sGrade || <span class="Type">string</span>.Empty != sRevNo)
<span class="lnr"> 290 </span>                        {
<span class="lnr"> 291 </span>                                <span class="Type">int</span> chkEmpty = <span class="Constant">0</span>;
<span class="lnr"> 292 </span>
<span class="lnr"> 293 </span>                                <span class="Statement">if</span> (sQuery.Contains(<span class="Constant">&quot; WHERE &quot;</span>))
<span class="lnr"> 294 </span>                                {
<span class="lnr"> 295 </span>                                        sQuery += <span class="Constant">&quot; C_KEY IN (SELECT DISTINCT C_KEY FROM T_ISSUED_REVISION WHERE C_REV_DATE IN (&quot;</span> + sIssueDate + <span class="Constant">&quot;))&quot;</span>;
<span class="lnr"> 296 </span>                                }
<span class="lnr"> 297 </span>                                <span class="Statement">else</span>
<span class="lnr"> 298 </span>                                {
<span class="lnr"> 299 </span>                                        sQuery += <span class="Constant">&quot; WHERE C_KEY IN (SELECT C_KEY FROM T_ISSUED_REVISION WHERE&quot;</span>;
<span class="lnr"> 300 </span>                                        <span class="Statement">if</span> (<span class="Type">string</span>.Empty != sIssueDate)
<span class="lnr"> 301 </span>                                        {
<span class="lnr"> 302 </span>                                                sQuery += <span class="Constant">&quot; C_REV_DATE IN (&quot;</span> + sIssueDate + <span class="Constant">&quot;)&quot;</span>;
<span class="lnr"> 303 </span>                                                chkEmpty++;
<span class="lnr"> 304 </span>                                        }
<span class="lnr"> 305 </span>                                        <span class="Statement">if</span> (<span class="Type">string</span>.Empty != sGrade)
<span class="lnr"> 306 </span>                                        {
<span class="lnr"> 307 </span>                                                <span class="Statement">if</span> (<span class="Constant">0</span> == chkEmpty)
<span class="lnr"> 308 </span>                                                {
<span class="lnr"> 309 </span>                                                        sQuery += <span class="Constant">&quot; C_GRADE IN ('&quot;</span> + sGrade + <span class="Constant">&quot;')&quot;</span>;
<span class="lnr"> 310 </span>                                                }
<span class="lnr"> 311 </span>                                                <span class="Statement">else</span>
<span class="lnr"> 312 </span>                                                {
<span class="lnr"> 313 </span>                                                        sQuery += <span class="Constant">&quot; AND C_GRADE IN ('&quot;</span> + sGrade + <span class="Constant">&quot;')&quot;</span>;
<span class="lnr"> 314 </span>                                                }
<span class="lnr"> 315 </span>                                                chkEmpty++;
<span class="lnr"> 316 </span>                                        }
<span class="lnr"> 317 </span>                                        <span class="Statement">if</span> (<span class="Type">string</span>.Empty != sGrade)
<span class="lnr"> 318 </span>                                        {
<span class="lnr"> 319 </span>                                                <span class="Statement">if</span> (<span class="Constant">0</span> == chkEmpty)
<span class="lnr"> 320 </span>                                                {
<span class="lnr"> 321 </span>                                                        sQuery += <span class="Constant">&quot; C_REV_NO IN (&quot;</span> + sRevNo + <span class="Constant">&quot;)&quot;</span>;
<span class="lnr"> 322 </span>                                                }
<span class="lnr"> 323 </span>                                                <span class="Statement">else</span>
<span class="lnr"> 324 </span>                                                {
<span class="lnr"> 325 </span>                                                        sQuery += <span class="Constant">&quot; AND C_REV_NO IN (&quot;</span> + sRevNo + <span class="Constant">&quot;)&quot;</span>;
<span class="lnr"> 326 </span>                                                }
<span class="lnr"> 327 </span>                                                chkEmpty++;
<span class="lnr"> 328 </span>                                        }
<span class="lnr"> 329 </span>                                        sQuery += <span class="Constant">&quot;)&quot;</span>;
<span class="lnr"> 330 </span>                                }
<span class="lnr"> 331 </span>                        }
<span class="lnr"> 332 </span>                        <span class="Statement">if</span> (<span class="Constant">&quot; AND&quot;</span> == sQuery.Substring(sQuery.Length - <span class="Constant">4</span>, <span class="Constant">4</span>))
<span class="lnr"> 333 </span>                        {
<span class="lnr"> 334 </span>                                sQuery = sQuery.Substring(<span class="Constant">0</span>, sQuery.Length - <span class="Constant">4</span>);
<span class="lnr"> 335 </span>                        }
<span class="lnr"> 336 </span>
<span class="lnr"> 337 </span>                        GetDataSetFrom(sQuery, <span class="Constant">true</span>);
<span class="lnr"> 338 </span>                        bindingSource1.DataSource = m_table;
<span class="lnr"> 339 </span>                        <span class="Comment">///</span><span class="Comment">! DataColumn oColumn </span>=<span class="Comment"> new DataColumn();</span>
<span class="lnr"> 340 </span>                        <span class="Comment">///</span><span class="Comment">! m_table.Columns.Add(&quot;C&quot;, typeof(System.Boolean));</span>
<span class="lnr"> 341 </span>                        dataGridView_LineData.DataSource = m_table;
<span class="lnr"> 342 </span>                        <span class="Comment">///</span><span class="Comment">! Resize the DataGridView columns to fit the newly loaded content.</span>
<span class="lnr"> 343 </span>                        dataGridView_LineData.AutoResizeColumns(DataGridViewAutoSizeColumnsMode.AllCells);
<span class="lnr"> 344 </span>
<span class="lnr"> 345 </span>                        <span class="Statement">for</span> (<span class="Type">int</span> i = <span class="Constant">1</span>; i &lt; dataGridView_LineData.Columns.Count; ++i)
<span class="lnr"> 346 </span>                        {
<span class="lnr"> 347 </span>                                dataGridView_LineData.Columns[i].ReadOnly = <span class="Constant">true</span>;
<span class="lnr"> 348 </span>                        }
<span class="lnr"> 349 </span>
<span class="lnr"> 350 </span>                        <span class="Type">int</span> iCancellationCount = <span class="Constant">0</span>;
<span class="lnr"> 351 </span>                        <span class="Statement">for</span> (<span class="Type">int</span> i = <span class="Constant">0</span>; i &lt; dataGridView_LineData.Rows.Count; ++i)
<span class="lnr"> 352 </span>                        {
<span class="lnr"> 353 </span>                                dataGridView_LineData.Rows[i].Cells[<span class="Constant">0</span>].Value = dataGridView_LineData.Rows[i].Cells[<span class="Constant">&quot;C_CANCELLATION&quot;</span>].Value;
<span class="lnr"> 354 </span>                                <span class="Type">object</span> oValue = dataGridView_LineData.Rows[i].Cells[<span class="Constant">0</span>].Value;
<span class="lnr"> 355 </span>                                <span class="Statement">if</span> ((<span class="Constant">null</span> != oValue) &amp;&amp; (<span class="Type">string</span>.Empty != oValue.ToString()) &amp;&amp; (<span class="Constant">true</span> == Convert.ToBoolean(oValue)))
<span class="lnr"> 356 </span>                                {
<span class="lnr"> 357 </span>                                        Font oFont = <span class="Statement">new</span> Font(dataGridView_LineData.Font, FontStyle.Strikeout);
<span class="lnr"> 358 </span>                                        <span class="Statement">for</span> (<span class="Type">int</span> j = <span class="Constant">1</span>; j &lt; dataGridView_LineData.Columns.Count; ++j)
<span class="lnr"> 359 </span>                                        {
<span class="lnr"> 360 </span>                                                dataGridView_LineData.Rows[i].Cells[j].Style.ForeColor = Color.FromArgb(<span class="Constant">255</span>, <span class="Constant">0</span>, <span class="Constant">0</span>);
<span class="lnr"> 361 </span>                                                dataGridView_LineData.Rows[i].Cells[j].Style.Font = oFont;
<span class="lnr"> 362 </span>                                        }
<span class="lnr"> 363 </span>                                        ++iCancellationCount;
<span class="lnr"> 364 </span>                                }
<span class="lnr"> 365 </span>                        }
<span class="lnr"> 366 </span>                        dataGridView_LineData.Columns[<span class="Constant">0</span>].Width = <span class="Constant">20</span>;
<span class="lnr"> 367 </span>
<span class="lnr"> 368 </span>                        <span class="Comment">///</span>
<span class="lnr"> 369 </span>                        <span class="Statement">if</span> (iCancellationCount &gt; <span class="Constant">0</span>)
<span class="lnr"> 370 </span>                        {
<span class="lnr"> 371 </span>                                MessageBox.Show(<span class="Constant">&quot;Cancellation된 Issue 기록이 있습니다&quot;</span>);
<span class="lnr"> 372 </span>                        }
<span class="lnr"> 373 </span>                }
<span class="lnr"> 374 </span>
<span class="lnr"> 375 </span>                <span class="Comment">/*</span>
<span class="lnr"> 376 </span><span class="Comment">                 *      @brief</span>
<span class="lnr"> 377 </span><span class="Comment">                 *      </span>
<span class="lnr"> 378 </span><span class="Comment">                 *      @author HumKyung</span>
<span class="lnr"> 379 </span><span class="Comment">                 *      </span>
<span class="lnr"> 380 </span><span class="Comment">                 *      @date   2011.02.17</span>
<span class="lnr"> 381 </span><span class="Comment">                 *</span>
<span class="lnr"> 382 </span><span class="Comment">                 *      @param  sender</span>
<span class="lnr"> 383 </span><span class="Comment">                 *      @param  e</span>
<span class="lnr"> 384 </span><span class="Comment">                 *      </span>
<span class="lnr"> 385 </span><span class="Comment">                 *      @return</span>
<span class="lnr"> 386 </span><span class="Comment">                 */</span>
<span class="lnr"> 387 </span>                <span class="Type">private</span> <span class="Type">void</span> btnCommit_Click(<span class="Type">object</span> sender, EventArgs e)
<span class="lnr"> 388 </span>                {
<span class="lnr"> 389 </span>                        <span class="Type">string</span> sConnection = <span class="Constant">&quot;Provider=Microsoft.Jet.OLEDB.4.0;Data Source=&quot;</span> + BusinessLogic.DatabasePath;
<span class="lnr"> 390 </span>
<span class="lnr"> 391 </span>                        <span class="Statement">try</span>
<span class="lnr"> 392 </span>                        {
<span class="lnr"> 393 </span>                                List&lt;<span class="Type">string</span>&gt; columnNameList = <span class="Statement">new</span> List&lt;<span class="Type">string</span>&gt; { };
<span class="lnr"> 394 </span>
<span class="lnr"> 395 </span>                                <span class="Type">object</span> obj = <span class="Statement">new</span> <span class="Type">object</span> { };
<span class="lnr"> 396 </span>
<span class="lnr"> 397 </span>                                <span class="Comment">//! dataGridView_LineData Update</span>
<span class="lnr"> 398 </span>                                <span class="Statement">foreach</span> (DataGridViewColumn dc <span class="Statement">in</span> dataGridView_LineData.Columns)
<span class="lnr"> 399 </span>                                {
<span class="lnr"> 400 </span>                                        columnNameList.Add(dc.Name.ToString());
<span class="lnr"> 401 </span>                                }
<span class="lnr"> 402 </span>
<span class="lnr"> 403 </span>                                m_connection.Open(sConnection, <span class="Constant">null</span>, <span class="Constant">null</span>, <span class="Constant">0</span>);
<span class="lnr"> 404 </span>                                <span class="Type">string</span> sCondition = <span class="Type">string</span>.Empty;
<span class="lnr"> 405 </span>                                <span class="Statement">foreach</span> (DataGridViewRow dr <span class="Statement">in</span> dataGridView_LineData.Rows)
<span class="lnr"> 406 </span>                                {
<span class="lnr"> 407 </span>                                        <span class="Type">int</span> i = <span class="Constant">0</span>;
<span class="lnr"> 408 </span>                                        <span class="Type">string</span> sValueList = <span class="Type">string</span>.Empty;
<span class="lnr"> 409 </span>                                        <span class="Statement">foreach</span> (DataGridViewCell dc <span class="Statement">in</span> dr.Cells)
<span class="lnr"> 410 </span>                                        {
<span class="lnr"> 411 </span>                                                <span class="Statement">if</span> (<span class="Constant">&quot;C_KEY&quot;</span> == columnNameList[i])
<span class="lnr"> 412 </span>                                                {
<span class="lnr"> 413 </span>                                                        sCondition = <span class="Constant">&quot;C_KEY='&quot;</span> + dc.Value + <span class="Constant">&quot;'&quot;</span>;
<span class="lnr"> 414 </span>                                                }
<span class="lnr"> 415 </span>                                                <span class="Statement">else</span>
<span class="lnr"> 416 </span>                                                {
<span class="lnr"> 417 </span>                                                        <span class="Type">string</span> sValue = dc.Value.ToString();
<span class="lnr"> 418 </span>                                                        <span class="Statement">if</span> (sValue.Contains(<span class="Constant">&quot;'&quot;</span>))
<span class="lnr"> 419 </span>                                                        {
<span class="lnr"> 420 </span>                                                                sValue = sValue.Replace(<span class="Constant">&quot;'&quot;</span>, <span class="Constant">&quot;''&quot;</span>);
<span class="lnr"> 421 </span>                                                        }
<span class="lnr"> 422 </span>
<span class="lnr"> 423 </span>                                                        sValueList += columnNameList[i] + <span class="Constant">&quot;='&quot;</span> + sValue + <span class="Constant">&quot;',&quot;</span>;
<span class="lnr"> 424 </span>                                                }
<span class="lnr"> 425 </span>                                                i++;
<span class="lnr"> 426 </span>                                        }
<span class="lnr"> 427 </span>                                        sValueList = sValueList.TrimEnd(<span class="Constant">&quot;,&quot;</span>.ToCharArray());
<span class="lnr"> 428 </span>
<span class="lnr"> 429 </span>                                        <span class="Type">string</span> sCommand = <span class="Constant">&quot;UPDATE T_ISSUED_LINE_DATA SET &quot;</span> + sValueList + <span class="Constant">&quot; WHERE &quot;</span> + sCondition;
<span class="lnr"> 430 </span>                                        <span class="Statement">try</span>
<span class="lnr"> 431 </span>                                        {
<span class="lnr"> 432 </span>                                                m_connection.Execute(sCommand, <span class="Statement">out</span> obj, <span class="Constant">0</span>);
<span class="lnr"> 433 </span>                                        }
<span class="lnr"> 434 </span>                                        <span class="Statement">catch</span> (OleDbException ex)
<span class="lnr"> 435 </span>                                        {
<span class="lnr"> 436 </span>                                                MessageBox.Show(ex.Errors.ToString());
<span class="lnr"> 437 </span>                                        }
<span class="lnr"> 438 </span>                                }
<span class="lnr"> 439 </span>
<span class="lnr"> 440 </span>                                <span class="Comment">//! dataGridView_RevisionData Update</span>
<span class="lnr"> 441 </span>                                columnNameList.Clear();
<span class="lnr"> 442 </span>
<span class="lnr"> 443 </span>                                <span class="Statement">foreach</span> (DataGridViewColumn dc <span class="Statement">in</span> dataGridView_RevisionData.Columns)
<span class="lnr"> 444 </span>                                {
<span class="lnr"> 445 </span>                                        columnNameList.Add(dc.Name.ToString());
<span class="lnr"> 446 </span>                                }
<span class="lnr"> 447 </span>
<span class="lnr"> 448 </span>                                sCondition = <span class="Type">string</span>.Empty;
<span class="lnr"> 449 </span>                                <span class="Type">string</span> sConditionRevNo = <span class="Type">string</span>.Empty;
<span class="lnr"> 450 </span>
<span class="lnr"> 451 </span>                                <span class="Statement">foreach</span> (DataGridViewRow dr <span class="Statement">in</span> dataGridView_RevisionData.Rows)
<span class="lnr"> 452 </span>                                {
<span class="lnr"> 453 </span>                                        <span class="Type">int</span> i = <span class="Constant">0</span>;
<span class="lnr"> 454 </span>                                        <span class="Type">string</span> sValueList = <span class="Type">string</span>.Empty;
<span class="lnr"> 455 </span>                                        <span class="Statement">foreach</span> (DataGridViewCell dc <span class="Statement">in</span> dr.Cells)
<span class="lnr"> 456 </span>                                        {
<span class="lnr"> 457 </span>                                                <span class="Statement">if</span> (<span class="Constant">&quot;C_KEY&quot;</span> == columnNameList[i])
<span class="lnr"> 458 </span>                                                {
<span class="lnr"> 459 </span>                                                        sCondition = <span class="Constant">&quot;C_KEY='&quot;</span> + dc.Value + <span class="Constant">&quot;'&quot;</span>;
<span class="lnr"> 460 </span>                                                }
<span class="lnr"> 461 </span>                                                <span class="Statement">else</span> <span class="Statement">if</span> (<span class="Constant">&quot;C_REV_NO&quot;</span> == columnNameList[i])
<span class="lnr"> 462 </span>                                                {
<span class="lnr"> 463 </span>                                                        sConditionRevNo = <span class="Constant">&quot;C_REV_NO='&quot;</span> + dc.Value + <span class="Constant">&quot;'&quot;</span>;
<span class="lnr"> 464 </span>                                                }
<span class="lnr"> 465 </span>                                                <span class="Statement">else</span>
<span class="lnr"> 466 </span>                                                {
<span class="lnr"> 467 </span>                                                        <span class="Type">string</span> sValue = dc.Value.ToString();
<span class="lnr"> 468 </span>                                                        <span class="Statement">if</span> (sValue.Contains(<span class="Constant">&quot;'&quot;</span>))
<span class="lnr"> 469 </span>                                                        {
<span class="lnr"> 470 </span>                                                                sValue = sValue.Replace(<span class="Constant">&quot;'&quot;</span>, <span class="Constant">&quot;''&quot;</span>);
<span class="lnr"> 471 </span>                                                        }
<span class="lnr"> 472 </span>
<span class="lnr"> 473 </span>                                                        sValueList += columnNameList[i] + <span class="Constant">&quot;='&quot;</span> + sValue + <span class="Constant">&quot;',&quot;</span>;
<span class="lnr"> 474 </span>                                                }
<span class="lnr"> 475 </span>                                                i++;
<span class="lnr"> 476 </span>                                        }
<span class="lnr"> 477 </span>                                        sValueList = sValueList.TrimEnd(<span class="Constant">&quot;,&quot;</span>.ToCharArray());
<span class="lnr"> 478 </span>
<span class="lnr"> 479 </span>                                        <span class="Type">string</span> sCommand = <span class="Constant">&quot;UPDATE T_ISSUED_REVISION SET &quot;</span> + sValueList + <span class="Constant">&quot; WHERE &quot;</span> + sCondition + <span class="Constant">&quot; AND &quot;</span> + sConditionRevNo;
<span class="lnr"> 480 </span>                                        <span class="Statement">try</span>
<span class="lnr"> 481 </span>                                        {
<span class="lnr"> 482 </span>                                                m_connection.Execute(sCommand, <span class="Statement">out</span> obj, <span class="Constant">0</span>);
<span class="lnr"> 483 </span>                                        }
<span class="lnr"> 484 </span>                                        <span class="Statement">catch</span> (OleDbException ex)
<span class="lnr"> 485 </span>                                        {
<span class="lnr"> 486 </span>                                                MessageBox.Show(ex.Errors.ToString());
<span class="lnr"> 487 </span>                                        }
<span class="lnr"> 488 </span>                                }
<span class="lnr"> 489 </span>
<span class="lnr"> 490 </span>                                m_connection.Close();
<span class="lnr"> 491 </span>                        }
<span class="lnr"> 492 </span>                        <span class="Statement">catch</span> (OleDbException ex)
<span class="lnr"> 493 </span>                        {
<span class="lnr"> 494 </span>                                MessageBox.Show(ex.Errors.ToString());
<span class="lnr"> 495 </span>                                m_connection.Close();
<span class="lnr"> 496 </span>                        }
<span class="lnr"> 497 </span>
<span class="lnr"> 498 </span>                }
<span class="lnr"> 499 </span>
<span class="lnr"> 500 </span>                <span class="Type">private</span> <span class="Type">void</span> btnCancel_Click(<span class="Type">object</span> sender, EventArgs e)
<span class="lnr"> 501 </span>                {
<span class="lnr"> 502 </span>                        <span class="Statement">this</span>.Close();
<span class="lnr"> 503 </span>                }
<span class="lnr"> 504 </span>
<span class="lnr"> 505 </span>                <span class="Type">private</span> <span class="Type">void</span> listBox1_SelectedIndexChanged(<span class="Type">object</span> sender, EventArgs e)
<span class="lnr"> 506 </span>                {
<span class="lnr"> 507 </span>
<span class="lnr"> 508 </span>                }
<span class="lnr"> 509 </span>
<span class="lnr"> 510 </span>                <span class="Type">private</span> <span class="Type">void</span> checkBox_ISSUE_DATE_CheckedChanged(<span class="Type">object</span> sender, EventArgs e)
<span class="lnr"> 511 </span>                {
<span class="lnr"> 512 </span>                        listISSUE_DATE.Enabled = checkBox_ISSUE_DATE.Checked;
<span class="lnr"> 513 </span>                        comboBox_REVISION_OPTION.Enabled = checkBox_ISSUE_DATE.Checked;
<span class="lnr"> 514 </span>                        <span class="Statement">if</span> (chkGrade.Checked &amp;&amp; chkREV.Checked &amp;&amp; checkBox_ISSUE_DATE.Checked)
<span class="lnr"> 515 </span>                        {
<span class="lnr"> 516 </span>                                chkALL.Enabled = <span class="Constant">true</span>;
<span class="lnr"> 517 </span>                        }
<span class="lnr"> 518 </span>                        <span class="Statement">else</span>
<span class="lnr"> 519 </span>                        {
<span class="lnr"> 520 </span>                                chkALL.Enabled = <span class="Constant">false</span>;
<span class="lnr"> 521 </span>                        }
<span class="lnr"> 522 </span>                }
<span class="lnr"> 523 </span>
<span class="lnr"> 524 </span>                <span class="Type">private</span> <span class="Type">void</span> listPLANT_MouseDoubleClick(<span class="Type">object</span> sender, MouseEventArgs e)
<span class="lnr"> 525 </span>                {
<span class="lnr"> 526 </span>                        <span class="Statement">if</span> (-<span class="Constant">1</span> != listPLANT.SelectedIndex)
<span class="lnr"> 527 </span>                        {
<span class="lnr"> 528 </span>                                OnDblclkQueryItem(<span class="Statement">ref</span> listPLANT, listPLANT.SelectedIndex);
<span class="lnr"> 529 </span>                                UpdateAreaNoListBox();
<span class="lnr"> 530 </span>
<span class="lnr"> 531 </span>                                List&lt;<span class="Type">string</span>&gt; stringList = <span class="Statement">new</span> List&lt;<span class="Type">string</span>&gt; { };
<span class="lnr"> 532 </span>                                <span class="Statement">for</span> (<span class="Type">int</span> i = <span class="Constant">0</span>; i &lt; listAREA.Items.Count; ++i)
<span class="lnr"> 533 </span>                                {
<span class="lnr"> 534 </span>                                        stringList.Add(listAREA.Items[i].ToString());
<span class="lnr"> 535 </span>                                }
<span class="lnr"> 536 </span>                                listAREA.Items.Clear();
<span class="lnr"> 537 </span>                                <span class="Statement">for</span> (<span class="Type">int</span> i = <span class="Constant">0</span>; i &lt; stringList.Count; ++i)
<span class="lnr"> 538 </span>                                {
<span class="lnr"> 539 </span>                                        <span class="Type">string</span> sTemp = stringList[i].Replace(<span class="Constant">&quot;@&quot;</span>, <span class="Constant">&quot;&quot;</span>);
<span class="lnr"> 540 </span>                                        listAREA.Items.Add(sTemp);
<span class="lnr"> 541 </span>                                }
<span class="lnr"> 542 </span>                        }
<span class="lnr"> 543 </span>                }
<span class="lnr"> 544 </span>
<span class="lnr"> 545 </span>                <span class="Comment">/*</span>
<span class="lnr"> 546 </span><span class="Comment">                        @brief</span>
<span class="lnr"> 547 </span><span class="Comment">                        </span>
<span class="lnr"> 548 </span><span class="Comment">                 *      @author HumKyung</span>
<span class="lnr"> 549 </span><span class="Comment">                 *      </span>
<span class="lnr"> 550 </span><span class="Comment">                 *      @date   2011.02.15</span>
<span class="lnr"> 551 </span><span class="Comment">                 *      </span>
<span class="lnr"> 552 </span><span class="Comment">                 *      @param  listbox</span>
<span class="lnr"> 553 </span><span class="Comment">                 *      @param  iSel</span>
<span class="lnr"> 554 </span><span class="Comment">                 *      </span>
<span class="lnr"> 555 </span><span class="Comment">                 *      @return</span>
<span class="lnr"> 556 </span><span class="Comment">                 */</span>
<span class="lnr"> 557 </span>                <span class="Type">private</span> <span class="Type">void</span> OnDblclkQueryItem(<span class="Statement">ref</span> ListBox listbox, <span class="Type">int</span> iSel)
<span class="lnr"> 558 </span>                {
<span class="lnr"> 559 </span>                        <span class="Type">string</span> sString = listbox.Items[iSel].ToString();
<span class="lnr"> 560 </span>                        <span class="Statement">if</span> (sString.Contains(<span class="Constant">&quot;[all]&quot;</span>))
<span class="lnr"> 561 </span>                        {
<span class="lnr"> 562 </span>                                <span class="Statement">if</span> (<span class="Constant">&quot;@&quot;</span> == sString.Substring(<span class="Constant">0</span>, <span class="Constant">1</span>))
<span class="lnr"> 563 </span>                                {
<span class="lnr"> 564 </span>                                        <span class="Statement">for</span> (<span class="Type">int</span> i = <span class="Constant">0</span>; i &lt; listbox.Items.Count; ++i)
<span class="lnr"> 565 </span>                                        {
<span class="lnr"> 566 </span>                                                <span class="Type">string</span> sItemText = listbox.Items[i].ToString();
<span class="lnr"> 567 </span>                                                <span class="Statement">if</span> (<span class="Constant">&quot;@&quot;</span> == sItemText.Substring(<span class="Constant">0</span>, <span class="Constant">1</span>))
<span class="lnr"> 568 </span>                                                {
<span class="lnr"> 569 </span>                                                        listbox.Items.RemoveAt(i);
<span class="lnr"> 570 </span>                                                        sItemText = sItemText.Substring(<span class="Constant">1</span>);
<span class="lnr"> 571 </span>                                                        listbox.Items.Insert(i, sItemText);
<span class="lnr"> 572 </span>                                                }
<span class="lnr"> 573 </span>                                        }
<span class="lnr"> 574 </span>                                }
<span class="lnr"> 575 </span>                                <span class="Statement">else</span>
<span class="lnr"> 576 </span>                                {
<span class="lnr"> 577 </span>                                        <span class="Statement">for</span> (<span class="Type">int</span> i = <span class="Constant">0</span>; i &lt; listbox.Items.Count; ++i)
<span class="lnr"> 578 </span>                                        {
<span class="lnr"> 579 </span>                                                <span class="Type">string</span> sItemText = listbox.Items[i].ToString();
<span class="lnr"> 580 </span>                                                <span class="Statement">if</span> (<span class="Constant">&quot;@&quot;</span> != sItemText.Substring(<span class="Constant">0</span>, <span class="Constant">1</span>))
<span class="lnr"> 581 </span>                                                {
<span class="lnr"> 582 </span>                                                        listbox.Items.RemoveAt(i);
<span class="lnr"> 583 </span>                                                        sItemText = <span class="Constant">&quot;@&quot;</span> + sItemText;
<span class="lnr"> 584 </span>                                                        listbox.Items.Insert(i, sItemText);
<span class="lnr"> 585 </span>                                                }
<span class="lnr"> 586 </span>                                        }
<span class="lnr"> 587 </span>                                }
<span class="lnr"> 588 </span>                        }
<span class="lnr"> 589 </span>                        <span class="Statement">else</span>
<span class="lnr"> 590 </span>                        {
<span class="lnr"> 591 </span>                                <span class="Statement">if</span> (<span class="Constant">&quot;@&quot;</span> == sString.Substring(<span class="Constant">0</span>, <span class="Constant">1</span>))
<span class="lnr"> 592 </span>                                {
<span class="lnr"> 593 </span>                                        sString.Replace(<span class="Constant">&quot;@ &quot;</span>, <span class="Constant">&quot;&quot;</span>);
<span class="lnr"> 594 </span>                                        listbox.Items.RemoveAt(iSel);
<span class="lnr"> 595 </span>                                        listbox.Items.Insert(iSel, sString);
<span class="lnr"> 596 </span>
<span class="lnr"> 597 </span>                                        <span class="Statement">if</span> (<span class="Constant">&quot;@&quot;</span> == listbox.Items[<span class="Constant">0</span>].ToString())
<span class="lnr"> 598 </span>                                        {
<span class="lnr"> 599 </span>                                                sString = listbox.Items[<span class="Constant">0</span>].ToString().Replace(<span class="Constant">&quot;@ &quot;</span>, <span class="Constant">&quot;&quot;</span>);
<span class="lnr"> 600 </span>                                                listbox.Items.RemoveAt(<span class="Constant">0</span>);
<span class="lnr"> 601 </span>                                                listbox.Items.Insert(<span class="Constant">0</span>, sString);
<span class="lnr"> 602 </span>                                        }
<span class="lnr"> 603 </span>                                }
<span class="lnr"> 604 </span>                                <span class="Statement">else</span>
<span class="lnr"> 605 </span>                                {
<span class="lnr"> 606 </span>                                        sString = <span class="Constant">&quot;@ &quot;</span> + sString;
<span class="lnr"> 607 </span>                                        listbox.Items.RemoveAt(iSel);
<span class="lnr"> 608 </span>                                        listbox.Items.Insert(iSel, sString);
<span class="lnr"> 609 </span>                                }
<span class="lnr"> 610 </span>                        }
<span class="lnr"> 611 </span>                }
<span class="lnr"> 612 </span>
<span class="lnr"> 613 </span>                <span class="Comment">/*</span>
<span class="lnr"> 614 </span><span class="Comment">                 *      @brief  get selected item text</span>
<span class="lnr"> 615 </span><span class="Comment">                 *      </span>
<span class="lnr"> 616 </span><span class="Comment">                 *      @author HumKyung</span>
<span class="lnr"> 617 </span><span class="Comment">                 *      </span>
<span class="lnr"> 618 </span><span class="Comment">                 *      @date   2011.02.15</span>
<span class="lnr"> 619 </span><span class="Comment">                 *      </span>
<span class="lnr"> 620 </span><span class="Comment">                 *      @param  listbox</span>
<span class="lnr"> 621 </span><span class="Comment">                 *      @param  iSel</span>
<span class="lnr"> 622 </span><span class="Comment">                 *      </span>
<span class="lnr"> 623 </span><span class="Comment">                 *      @return</span>
<span class="lnr"> 624 </span><span class="Comment">                 */</span>
<span class="lnr"> 625 </span>                <span class="Type">private</span> <span class="Type">string</span> GetSelItemText(<span class="Statement">ref</span> ListBox listbox)
<span class="lnr"> 626 </span>                {
<span class="lnr"> 627 </span>                        <span class="Type">string</span> sSelItemText = <span class="Type">string</span>.Empty;
<span class="lnr"> 628 </span>                        <span class="Statement">for</span> (<span class="Type">int</span> i = <span class="Constant">0</span>; i &lt; listbox.Items.Count; ++i)
<span class="lnr"> 629 </span>                        {
<span class="lnr"> 630 </span>                                <span class="Type">string</span> sItemText = listbox.Items[i].ToString();
<span class="lnr"> 631 </span>                                <span class="Statement">if</span> (<span class="Constant">&quot;@&quot;</span> == sItemText.Substring(<span class="Constant">0</span>, <span class="Constant">1</span>))
<span class="lnr"> 632 </span>                                {
<span class="lnr"> 633 </span>                                        <span class="Statement">if</span> (sItemText.Contains(<span class="Constant">&quot;[all]&quot;</span>))
<span class="lnr"> 634 </span>                                        {
<span class="lnr"> 635 </span>                                                sSelItemText = <span class="Constant">&quot;ALL&quot;</span>;
<span class="lnr"> 636 </span>                                                <span class="Statement">break</span>;
<span class="lnr"> 637 </span>                                        }
<span class="lnr"> 638 </span>                                        <span class="Statement">else</span>
<span class="lnr"> 639 </span>                                        {
<span class="lnr"> 640 </span>                                                sSelItemText += <span class="Constant">&quot;'&quot;</span> + sItemText.Substring(<span class="Constant">2</span>) + <span class="Constant">&quot;',&quot;</span>;
<span class="lnr"> 641 </span>                                        }
<span class="lnr"> 642 </span>                                }
<span class="lnr"> 643 </span>                        }
<span class="lnr"> 644 </span>                        <span class="Statement">if</span> ((<span class="Type">string</span>.Empty != sSelItemText) &amp;&amp; (<span class="Constant">&quot;,&quot;</span> == sSelItemText.Substring(sSelItemText.Length - <span class="Constant">1</span>, <span class="Constant">1</span>)))
<span class="lnr"> 645 </span>                        {
<span class="lnr"> 646 </span>                                sSelItemText = sSelItemText.Substring(<span class="Constant">0</span>, sSelItemText.Length - <span class="Constant">1</span>);
<span class="lnr"> 647 </span>                        }
<span class="lnr"> 648 </span>
<span class="lnr"> 649 </span>                        <span class="Statement">return</span> sSelItemText;
<span class="lnr"> 650 </span>                }
<span class="lnr"> 651 </span>
<span class="lnr"> 652 </span>                <span class="Comment">/*</span>
<span class="lnr"> 653 </span><span class="Comment">                 *      @brief</span>
<span class="lnr"> 654 </span><span class="Comment">                 *      </span>
<span class="lnr"> 655 </span><span class="Comment">                 *      @author HumKyung</span>
<span class="lnr"> 656 </span><span class="Comment">                 *      </span>
<span class="lnr"> 657 </span><span class="Comment">                 *      @date   2011.02.15</span>
<span class="lnr"> 658 </span><span class="Comment">                 *      </span>
<span class="lnr"> 659 </span><span class="Comment">                 *      @param  listbox</span>
<span class="lnr"> 660 </span><span class="Comment">                 *      @param  iSel</span>
<span class="lnr"> 661 </span><span class="Comment">                 *      </span>
<span class="lnr"> 662 </span><span class="Comment">                 *      @return</span>
<span class="lnr"> 663 </span><span class="Comment">                 */</span>
<span class="lnr"> 664 </span>                <span class="Type">private</span> <span class="Type">void</span> UpdateAreaNoListBox()
<span class="lnr"> 665 </span>                {
<span class="lnr"> 666 </span>                        <span class="Type">string</span> sQuery = <span class="Constant">&quot;SELECT DISTINCT C_AREA_NO FROM T_ISSUED_LINE_DATA&quot;</span>;
<span class="lnr"> 667 </span>                        <span class="Type">string</span> sCondition = GetSelItemText(<span class="Statement">ref</span> listPLANT);
<span class="lnr"> 668 </span>
<span class="lnr"> 669 </span>                        <span class="Statement">if</span> (<span class="Constant">&quot;ALL&quot;</span> == sCondition)
<span class="lnr"> 670 </span>                        {
<span class="lnr"> 671 </span>                                GetDataSetFrom(sQuery, <span class="Constant">false</span>);
<span class="lnr"> 672 </span>                        }
<span class="lnr"> 673 </span>                        <span class="Statement">else</span> <span class="Statement">if</span> (<span class="Type">string</span>.Empty != sCondition)
<span class="lnr"> 674 </span>                        {
<span class="lnr"> 675 </span>                                sQuery += <span class="Constant">&quot; WHERE C_PLANT_NO IN (&quot;</span> + sCondition + <span class="Constant">&quot;)&quot;</span>;
<span class="lnr"> 676 </span>                                GetDataSetFrom(sQuery, <span class="Constant">false</span>);
<span class="lnr"> 677 </span>                        }
<span class="lnr"> 678 </span>
<span class="lnr"> 679 </span>                        <span class="Statement">for</span> (<span class="Type">int</span> i = listAREA.Items.Count - <span class="Constant">1</span>; i &gt;= <span class="Constant">1</span>; --i)
<span class="lnr"> 680 </span>                        {
<span class="lnr"> 681 </span>                                listAREA.Items.RemoveAt(i);
<span class="lnr"> 682 </span>                        }
<span class="lnr"> 683 </span>                        <span class="Statement">foreach</span> (DataRow dr <span class="Statement">in</span> m_table.Rows)
<span class="lnr"> 684 </span>                        {
<span class="lnr"> 685 </span>                                listAREA.Items.Add(dr[<span class="Constant">0</span>].ToString());
<span class="lnr"> 686 </span>                        }
<span class="lnr"> 687 </span>                }
<span class="lnr"> 688 </span>
<span class="lnr"> 689 </span>                <span class="Comment">/*</span>
<span class="lnr"> 690 </span><span class="Comment">                 *      @brief</span>
<span class="lnr"> 691 </span><span class="Comment">                 *      </span>
<span class="lnr"> 692 </span><span class="Comment">                 *      @author HumKyung</span>
<span class="lnr"> 693 </span><span class="Comment">                 *      </span>
<span class="lnr"> 694 </span><span class="Comment">                 *      @date   2011.02.15</span>
<span class="lnr"> 695 </span><span class="Comment">                 *      </span>
<span class="lnr"> 696 </span><span class="Comment">                 *      @param  listbox</span>
<span class="lnr"> 697 </span><span class="Comment">                 *      @param  iSel</span>
<span class="lnr"> 698 </span><span class="Comment">                 *      </span>
<span class="lnr"> 699 </span><span class="Comment">                 *      @return</span>
<span class="lnr"> 700 </span><span class="Comment">                 */</span>
<span class="lnr"> 701 </span>                <span class="Type">private</span> <span class="Type">void</span> listAREA_MouseDoubleClick(<span class="Type">object</span> sender, MouseEventArgs e)
<span class="lnr"> 702 </span>                {
<span class="lnr"> 703 </span>                        <span class="Statement">if</span> (-<span class="Constant">1</span> != listAREA.SelectedIndex)
<span class="lnr"> 704 </span>                        {
<span class="lnr"> 705 </span>                                OnDblclkQueryItem(<span class="Statement">ref</span> listAREA, listAREA.SelectedIndex);
<span class="lnr"> 706 </span>                                UpdateUnitNoListBox();
<span class="lnr"> 707 </span>                        }
<span class="lnr"> 708 </span>                }
<span class="lnr"> 709 </span>
<span class="lnr"> 710 </span>                <span class="Comment">/*</span>
<span class="lnr"> 711 </span><span class="Comment">                 *      @brief</span>
<span class="lnr"> 712 </span><span class="Comment">                 *      </span>
<span class="lnr"> 713 </span><span class="Comment">                 *      @author HumKyung</span>
<span class="lnr"> 714 </span><span class="Comment">                 *      </span>
<span class="lnr"> 715 </span><span class="Comment">                 *      @date   2011.02.15</span>
<span class="lnr"> 716 </span><span class="Comment">                 *      </span>
<span class="lnr"> 717 </span><span class="Comment">                 *      @param  listbox</span>
<span class="lnr"> 718 </span><span class="Comment">                 *      @param  iSel</span>
<span class="lnr"> 719 </span><span class="Comment">                 *      </span>
<span class="lnr"> 720 </span><span class="Comment">                 *      @return</span>
<span class="lnr"> 721 </span><span class="Comment">                 */</span>
<span class="lnr"> 722 </span>                <span class="Type">private</span> <span class="Type">void</span> UpdateUnitNoListBox()
<span class="lnr"> 723 </span>                {
<span class="lnr"> 724 </span>                        <span class="Type">string</span> sQuery = <span class="Constant">&quot;SELECT DISTINCT C_UNIT_NO FROM T_ISSUED_LINE_DATA&quot;</span>;
<span class="lnr"> 725 </span>                        <span class="Type">string</span> sSelPlantNo = GetSelItemText(<span class="Statement">ref</span> listPLANT);
<span class="lnr"> 726 </span>                        <span class="Type">string</span> sSelAreaNo = GetSelItemText(<span class="Statement">ref</span> listAREA);
<span class="lnr"> 727 </span>
<span class="lnr"> 728 </span>                        <span class="Statement">if</span> ((<span class="Type">string</span>.Empty != sSelPlantNo) &amp;&amp; (<span class="Constant">&quot;ALL&quot;</span> != sSelPlantNo))
<span class="lnr"> 729 </span>                        {
<span class="lnr"> 730 </span>                                sQuery += <span class="Constant">&quot; WHERE C_PLANT_NO IN (&quot;</span> + sSelPlantNo + <span class="Constant">&quot;)&quot;</span>;
<span class="lnr"> 731 </span>
<span class="lnr"> 732 </span>                                <span class="Statement">if</span> ((<span class="Type">string</span>.Empty != sSelAreaNo) &amp;&amp; (<span class="Constant">&quot;ALL&quot;</span> != sSelAreaNo))
<span class="lnr"> 733 </span>                                {
<span class="lnr"> 734 </span>                                        sQuery += <span class="Constant">&quot; AND C_AREA_NO IN (&quot;</span> + sSelAreaNo + <span class="Constant">&quot;)&quot;</span>;
<span class="lnr"> 735 </span>                                }
<span class="lnr"> 736 </span>                        }
<span class="lnr"> 737 </span>                        <span class="Statement">else</span>
<span class="lnr"> 738 </span>                        {
<span class="lnr"> 739 </span>                                <span class="Statement">if</span> ((<span class="Type">string</span>.Empty != sSelAreaNo) &amp;&amp; (<span class="Constant">&quot;ALL&quot;</span> != sSelAreaNo))
<span class="lnr"> 740 </span>                                {
<span class="lnr"> 741 </span>                                        sQuery += <span class="Constant">&quot; WHERE C_AREA_NO IN (&quot;</span> + sSelAreaNo + <span class="Constant">&quot;)&quot;</span>;
<span class="lnr"> 742 </span>                                }
<span class="lnr"> 743 </span>                        }
<span class="lnr"> 744 </span>
<span class="lnr"> 745 </span>                        GetDataSetFrom(sQuery, <span class="Constant">false</span>);
<span class="lnr"> 746 </span>                        <span class="Statement">for</span> (<span class="Type">int</span> i = listUNIT.Items.Count - <span class="Constant">1</span>; i &gt;= <span class="Constant">1</span>; --i)
<span class="lnr"> 747 </span>                        {
<span class="lnr"> 748 </span>                                listUNIT.Items.RemoveAt(i);
<span class="lnr"> 749 </span>                        }
<span class="lnr"> 750 </span>                        <span class="Statement">foreach</span> (DataRow dr <span class="Statement">in</span> m_table.Rows)
<span class="lnr"> 751 </span>                        {
<span class="lnr"> 752 </span>                                listUNIT.Items.Add(dr[<span class="Constant">0</span>].ToString());
<span class="lnr"> 753 </span>                        }
<span class="lnr"> 754 </span>                }
<span class="lnr"> 755 </span>
<span class="lnr"> 756 </span>                <span class="Comment">/*</span>
<span class="lnr"> 757 </span><span class="Comment">                 *      @brief</span>
<span class="lnr"> 758 </span><span class="Comment">                 *      </span>
<span class="lnr"> 759 </span><span class="Comment">                 *      @author HumKyung</span>
<span class="lnr"> 760 </span><span class="Comment">                 *      </span>
<span class="lnr"> 761 </span><span class="Comment">                 *      @date   2011.02.15</span>
<span class="lnr"> 762 </span><span class="Comment">                 *      </span>
<span class="lnr"> 763 </span><span class="Comment">                 *      @param  listbox</span>
<span class="lnr"> 764 </span><span class="Comment">                 *      @param  iSel</span>
<span class="lnr"> 765 </span><span class="Comment">                 *      </span>
<span class="lnr"> 766 </span><span class="Comment">                 *      @return</span>
<span class="lnr"> 767 </span><span class="Comment">                 */</span>
<span class="lnr"> 768 </span>                <span class="Type">private</span> <span class="Type">void</span> listUNIT_MouseDoubleClick(<span class="Type">object</span> sender, MouseEventArgs e)
<span class="lnr"> 769 </span>                {
<span class="lnr"> 770 </span>                        <span class="Statement">if</span> (-<span class="Constant">1</span> != listUNIT.SelectedIndex)
<span class="lnr"> 771 </span>                        {
<span class="lnr"> 772 </span>                                OnDblclkQueryItem(<span class="Statement">ref</span> listUNIT, listUNIT.SelectedIndex);
<span class="lnr"> 773 </span>                                UpdateSectionNoListBox();
<span class="lnr"> 774 </span>                        }
<span class="lnr"> 775 </span>                }
<span class="lnr"> 776 </span>
<span class="lnr"> 777 </span>                <span class="Comment">/*</span>
<span class="lnr"> 778 </span><span class="Comment">                 *      @brief</span>
<span class="lnr"> 779 </span><span class="Comment">                 *      </span>
<span class="lnr"> 780 </span><span class="Comment">                 *      @author HumKyung</span>
<span class="lnr"> 781 </span><span class="Comment">                 *      </span>
<span class="lnr"> 782 </span><span class="Comment">                 *      @date   2011.02.15</span>
<span class="lnr"> 783 </span><span class="Comment">                 *      </span>
<span class="lnr"> 784 </span><span class="Comment">                 *      @param  listbox</span>
<span class="lnr"> 785 </span><span class="Comment">                 *      @param  iSel</span>
<span class="lnr"> 786 </span><span class="Comment">                 *      </span>
<span class="lnr"> 787 </span><span class="Comment">                 *      @return</span>
<span class="lnr"> 788 </span><span class="Comment">                 */</span>
<span class="lnr"> 789 </span>                <span class="Type">private</span> <span class="Type">void</span> UpdateSectionNoListBox()
<span class="lnr"> 790 </span>                {
<span class="lnr"> 791 </span>                        <span class="Type">string</span> sQuery = <span class="Constant">&quot;SELECT DISTINCT C_SECTION_NO FROM T_ISSUED_LINE_DATA&quot;</span>;
<span class="lnr"> 792 </span>                        <span class="Type">string</span> sSelPlantNo = GetSelItemText(<span class="Statement">ref</span> listPLANT);
<span class="lnr"> 793 </span>                        <span class="Type">string</span> sSelAreaNo = GetSelItemText(<span class="Statement">ref</span> listAREA);
<span class="lnr"> 794 </span>                        <span class="Type">string</span> sSelUnitNo = GetSelItemText(<span class="Statement">ref</span> listUNIT);
<span class="lnr"> 795 </span>
<span class="lnr"> 796 </span>                        <span class="Statement">if</span> ((<span class="Type">string</span>.Empty != sSelPlantNo) &amp;&amp; (<span class="Constant">&quot;ALL&quot;</span> != sSelPlantNo))
<span class="lnr"> 797 </span>                        {
<span class="lnr"> 798 </span>                                sQuery += <span class="Constant">&quot; WHERE C_PLANT_NO IN (&quot;</span> + sSelPlantNo + <span class="Constant">&quot;)&quot;</span>;
<span class="lnr"> 799 </span>
<span class="lnr"> 800 </span>                                <span class="Statement">if</span> ((<span class="Type">string</span>.Empty != sSelAreaNo) &amp;&amp; (<span class="Constant">&quot;ALL&quot;</span> != sSelAreaNo))
<span class="lnr"> 801 </span>                                {
<span class="lnr"> 802 </span>                                        sQuery += <span class="Constant">&quot; AND C_AREA_NO IN (&quot;</span> + sSelAreaNo + <span class="Constant">&quot;)&quot;</span>;
<span class="lnr"> 803 </span>                                }
<span class="lnr"> 804 </span>
<span class="lnr"> 805 </span>                                <span class="Statement">if</span> ((<span class="Type">string</span>.Empty != sSelUnitNo) &amp;&amp; (<span class="Constant">&quot;ALL&quot;</span> != sSelUnitNo))
<span class="lnr"> 806 </span>                                {
<span class="lnr"> 807 </span>                                        sQuery += <span class="Constant">&quot; AND C_UNIT_NO IN (&quot;</span> + sSelUnitNo + <span class="Constant">&quot;)&quot;</span>;
<span class="lnr"> 808 </span>                                }
<span class="lnr"> 809 </span>                        }
<span class="lnr"> 810 </span>                        <span class="Statement">else</span>
<span class="lnr"> 811 </span>                        {
<span class="lnr"> 812 </span>                                <span class="Statement">if</span> ((<span class="Type">string</span>.Empty != sSelAreaNo) &amp;&amp; (<span class="Constant">&quot;ALL&quot;</span> != sSelAreaNo))
<span class="lnr"> 813 </span>                                {
<span class="lnr"> 814 </span>                                        sQuery += <span class="Constant">&quot; WHERE C_AREA_NO IN (&quot;</span> + sSelAreaNo + <span class="Constant">&quot;)&quot;</span>;
<span class="lnr"> 815 </span>
<span class="lnr"> 816 </span>                                        <span class="Statement">if</span> ((<span class="Type">string</span>.Empty != sSelUnitNo) &amp;&amp; (<span class="Constant">&quot;ALL&quot;</span> != sSelUnitNo))
<span class="lnr"> 817 </span>                                        {
<span class="lnr"> 818 </span>                                                sQuery += <span class="Constant">&quot; AND C_UNIT_NO IN (&quot;</span> + sSelUnitNo + <span class="Constant">&quot;)&quot;</span>;
<span class="lnr"> 819 </span>                                        }
<span class="lnr"> 820 </span>                                }
<span class="lnr"> 821 </span>                                <span class="Statement">else</span>
<span class="lnr"> 822 </span>                                {
<span class="lnr"> 823 </span>                                        <span class="Statement">if</span> ((<span class="Type">string</span>.Empty != sSelUnitNo) &amp;&amp; (<span class="Constant">&quot;ALL&quot;</span> != sSelUnitNo))
<span class="lnr"> 824 </span>                                        {
<span class="lnr"> 825 </span>                                                sQuery += <span class="Constant">&quot; WHERE C_UNIT_NO IN (&quot;</span> + sSelUnitNo + <span class="Constant">&quot;)&quot;</span>;
<span class="lnr"> 826 </span>                                        }
<span class="lnr"> 827 </span>                                }
<span class="lnr"> 828 </span>                        }
<span class="lnr"> 829 </span>
<span class="lnr"> 830 </span>                        GetDataSetFrom(sQuery, <span class="Constant">false</span>);
<span class="lnr"> 831 </span>                        <span class="Statement">for</span> (<span class="Type">int</span> i = listSECTION.Items.Count - <span class="Constant">1</span>; i &gt;= <span class="Constant">1</span>; --i)
<span class="lnr"> 832 </span>                        {
<span class="lnr"> 833 </span>                                listSECTION.Items.RemoveAt(i);
<span class="lnr"> 834 </span>                        }
<span class="lnr"> 835 </span>                        <span class="Statement">foreach</span> (DataRow dr <span class="Statement">in</span> m_table.Rows)
<span class="lnr"> 836 </span>                        {
<span class="lnr"> 837 </span>                                listSECTION.Items.Add(dr[<span class="Constant">0</span>].ToString());
<span class="lnr"> 838 </span>                        }
<span class="lnr"> 839 </span>                }
<span class="lnr"> 840 </span>
<span class="lnr"> 841 </span>                <span class="Comment">/*</span>
<span class="lnr"> 842 </span><span class="Comment">                 *      @brief</span>
<span class="lnr"> 843 </span><span class="Comment">                 *      </span>
<span class="lnr"> 844 </span><span class="Comment">                 *      @author HumKyung</span>
<span class="lnr"> 845 </span><span class="Comment">                 *      </span>
<span class="lnr"> 846 </span><span class="Comment">                 *      @date   2011.02.15</span>
<span class="lnr"> 847 </span><span class="Comment">                 *      </span>
<span class="lnr"> 848 </span><span class="Comment">                 *      @param  listbox</span>
<span class="lnr"> 849 </span><span class="Comment">                 *      @param  iSel</span>
<span class="lnr"> 850 </span><span class="Comment">                 *      </span>
<span class="lnr"> 851 </span><span class="Comment">                 *      @return</span>
<span class="lnr"> 852 </span><span class="Comment">                 */</span>
<span class="lnr"> 853 </span>                <span class="Type">private</span> <span class="Type">void</span> listSECTION_MouseDoubleClick(<span class="Type">object</span> sender, MouseEventArgs e)
<span class="lnr"> 854 </span>                {
<span class="lnr"> 855 </span>                        <span class="Statement">if</span> (-<span class="Constant">1</span> != listSECTION.SelectedIndex)
<span class="lnr"> 856 </span>                        {
<span class="lnr"> 857 </span>                                OnDblclkQueryItem(<span class="Statement">ref</span> listSECTION, listSECTION.SelectedIndex);
<span class="lnr"> 858 </span>                        }
<span class="lnr"> 859 </span>                }
<span class="lnr"> 860 </span>
<span class="lnr"> 861 </span>                <span class="Comment">/*</span>
<span class="lnr"> 862 </span><span class="Comment">                 *      @brief</span>
<span class="lnr"> 863 </span><span class="Comment">                 *      </span>
<span class="lnr"> 864 </span><span class="Comment">                 *      @author HumKyung</span>
<span class="lnr"> 865 </span><span class="Comment">                 *      </span>
<span class="lnr"> 866 </span><span class="Comment">                 *      @date   2011.02.15</span>
<span class="lnr"> 867 </span><span class="Comment">                 *</span>
<span class="lnr"> 868 </span><span class="Comment">                 *      @return</span>
<span class="lnr"> 869 </span><span class="Comment">                 */</span>
<span class="lnr"> 870 </span>                <span class="Type">private</span> <span class="Type">string</span> GetSelectedIssueDate()
<span class="lnr"> 871 </span>                {
<span class="lnr"> 872 </span>                        <span class="Type">string</span> sIssueDate = <span class="Type">string</span>.Empty;
<span class="lnr"> 873 </span>
<span class="lnr"> 874 </span>                        <span class="Statement">if</span> (checkBox_ISSUE_DATE.Checked)
<span class="lnr"> 875 </span>                        {
<span class="lnr"> 876 </span>                                <span class="Statement">for</span> (<span class="Type">int</span> i = <span class="Constant">0</span>; i &lt; listISSUE_DATE.Items.Count; ++i)
<span class="lnr"> 877 </span>                                {
<span class="lnr"> 878 </span>                                        <span class="Statement">if</span> (listISSUE_DATE.Items[i].Checked)
<span class="lnr"> 879 </span>                                        {
<span class="lnr"> 880 </span>                                                sIssueDate += <span class="Constant">&quot;'&quot;</span> + listISSUE_DATE.Items[i].SubItems[<span class="Constant">0</span>].Text + <span class="Constant">&quot;',&quot;</span>;
<span class="lnr"> 881 </span>                                        }
<span class="lnr"> 882 </span>                                }
<span class="lnr"> 883 </span>
<span class="lnr"> 884 </span>                                <span class="Statement">if</span> ((<span class="Type">string</span>.Empty != sIssueDate) &amp;&amp; (<span class="Constant">&quot;,&quot;</span> == sIssueDate.Substring(sIssueDate.Length - <span class="Constant">1</span>, <span class="Constant">1</span>)))
<span class="lnr"> 885 </span>                                {
<span class="lnr"> 886 </span>                                        sIssueDate = sIssueDate.Substring(<span class="Constant">0</span>, sIssueDate.Length - <span class="Constant">1</span>);
<span class="lnr"> 887 </span>                                }
<span class="lnr"> 888 </span>                        }
<span class="lnr"> 889 </span>
<span class="lnr"> 890 </span>                        <span class="Statement">return</span> sIssueDate;
<span class="lnr"> 891 </span>                }
<span class="lnr"> 892 </span>
<span class="lnr"> 893 </span>                <span class="Comment">/*</span>
<span class="lnr"> 894 </span><span class="Comment">                 *      @brief</span>
<span class="lnr"> 895 </span><span class="Comment">                 *      </span>
<span class="lnr"> 896 </span><span class="Comment">                 *      @author KyoungMin</span>
<span class="lnr"> 897 </span><span class="Comment">                 *      </span>
<span class="lnr"> 898 </span><span class="Comment">                 *      @date   2011.02.23</span>
<span class="lnr"> 899 </span><span class="Comment">                 *</span>
<span class="lnr"> 900 </span><span class="Comment">                 *      @return</span>
<span class="lnr"> 901 </span><span class="Comment">                 */</span>
<span class="lnr"> 902 </span>                <span class="Type">private</span> <span class="Type">string</span> GetSelected_Grade()
<span class="lnr"> 903 </span>                {
<span class="lnr"> 904 </span>                        <span class="Type">string</span> sIssueGrade = <span class="Type">string</span>.Empty;
<span class="lnr"> 905 </span>
<span class="lnr"> 906 </span>                        <span class="Statement">if</span> (chkGrade.Checked)
<span class="lnr"> 907 </span>                        {
<span class="lnr"> 908 </span>                                <span class="Statement">for</span> (<span class="Type">int</span> i = <span class="Constant">0</span>; i &lt; lvwGRADE.Items.Count; ++i)
<span class="lnr"> 909 </span>                                {
<span class="lnr"> 910 </span>                                        <span class="Statement">if</span> (lvwGRADE.Items[i].Checked)
<span class="lnr"> 911 </span>                                        {
<span class="lnr"> 912 </span>                                                sIssueGrade += lvwGRADE.Items[i].SubItems[<span class="Constant">0</span>].Text + <span class="Constant">&quot;,&quot;</span>;
<span class="lnr"> 913 </span>                                        }
<span class="lnr"> 914 </span>                                }
<span class="lnr"> 915 </span>
<span class="lnr"> 916 </span>                                <span class="Statement">if</span> ((<span class="Type">string</span>.Empty != sIssueGrade) &amp;&amp; (<span class="Constant">&quot;,&quot;</span> == sIssueGrade.Substring(sIssueGrade.Length - <span class="Constant">1</span>, <span class="Constant">1</span>)))
<span class="lnr"> 917 </span>                                {
<span class="lnr"> 918 </span>                                        sIssueGrade = sIssueGrade.Substring(<span class="Constant">0</span>, sIssueGrade.Length - <span class="Constant">1</span>);
<span class="lnr"> 919 </span>                                }
<span class="lnr"> 920 </span>                        }
<span class="lnr"> 921 </span>
<span class="lnr"> 922 </span>                        <span class="Statement">return</span> sIssueGrade;
<span class="lnr"> 923 </span>                }
<span class="lnr"> 924 </span>
<span class="lnr"> 925 </span>                <span class="Comment">/*</span>
<span class="lnr"> 926 </span><span class="Comment">                 *      @brief</span>
<span class="lnr"> 927 </span><span class="Comment">                 *      </span>
<span class="lnr"> 928 </span><span class="Comment">                 *      @author KyoungMin</span>
<span class="lnr"> 929 </span><span class="Comment">                 *      </span>
<span class="lnr"> 930 </span><span class="Comment">                 *      @date   2011.02.23</span>
<span class="lnr"> 931 </span><span class="Comment">                 *</span>
<span class="lnr"> 932 </span><span class="Comment">                 *      @return</span>
<span class="lnr"> 933 </span><span class="Comment">                 */</span>
<span class="lnr"> 934 </span>                <span class="Type">private</span> <span class="Type">string</span> GetSelected_RevNo()
<span class="lnr"> 935 </span>                {
<span class="lnr"> 936 </span>                        <span class="Type">string</span> sIssueRevNo = <span class="Type">string</span>.Empty;
<span class="lnr"> 937 </span>
<span class="lnr"> 938 </span>                        <span class="Statement">if</span> (chkREV.Checked)
<span class="lnr"> 939 </span>                        {
<span class="lnr"> 940 </span>                                <span class="Statement">for</span> (<span class="Type">int</span> i = <span class="Constant">0</span>; i &lt; lvwREV.Items.Count; ++i)
<span class="lnr"> 941 </span>                                {
<span class="lnr"> 942 </span>                                        <span class="Statement">if</span> (lvwREV.Items[i].Checked)
<span class="lnr"> 943 </span>                                        {
<span class="lnr"> 944 </span>                                                sIssueRevNo += <span class="Constant">&quot;'&quot;</span> + lvwREV.Items[i].Tag.ToString()<span class="Comment">/*.SubItems[0].Text*/</span> + <span class="Constant">&quot;',&quot;</span>;
<span class="lnr"> 945 </span>                                        }
<span class="lnr"> 946 </span>                                }
<span class="lnr"> 947 </span>
<span class="lnr"> 948 </span>                                <span class="Statement">if</span> ((<span class="Type">string</span>.Empty != sIssueRevNo) &amp;&amp; (<span class="Constant">&quot;,&quot;</span> == sIssueRevNo.Substring(sIssueRevNo.Length - <span class="Constant">1</span>, <span class="Constant">1</span>)))
<span class="lnr"> 949 </span>                                {
<span class="lnr"> 950 </span>                                        sIssueRevNo = sIssueRevNo.Substring(<span class="Constant">0</span>, sIssueRevNo.Length - <span class="Constant">1</span>);
<span class="lnr"> 951 </span>                                }
<span class="lnr"> 952 </span>                        }
<span class="lnr"> 953 </span>
<span class="lnr"> 954 </span>                        <span class="Statement">return</span> sIssueRevNo;
<span class="lnr"> 955 </span>                }
<span class="lnr"> 956 </span>                <span class="Comment">/*</span>
<span class="lnr"> 957 </span><span class="Comment">                 *      @brief</span>
<span class="lnr"> 958 </span><span class="Comment">                 *      </span>
<span class="lnr"> 959 </span><span class="Comment">                 *      @author HumKyung</span>
<span class="lnr"> 960 </span><span class="Comment">                 *      </span>
<span class="lnr"> 961 </span><span class="Comment">                 *      @date   2011.02.15</span>
<span class="lnr"> 962 </span><span class="Comment">                 *</span>
<span class="lnr"> 963 </span><span class="Comment">                 *      @return</span>
<span class="lnr"> 964 </span><span class="Comment">                 */</span>
<span class="lnr"> 965 </span>                <span class="Type">private</span> <span class="Type">string</span> GetSelectedRevNo()
<span class="lnr"> 966 </span>                {
<span class="lnr"> 967 </span>                        <span class="Type">string</span> sSelectedRevNo = <span class="Type">string</span>.Empty;
<span class="lnr"> 968 </span>
<span class="lnr"> 969 </span>                        <span class="Statement">if</span> (checkBox_ISSUE_DATE.Checked)
<span class="lnr"> 970 </span>                        {
<span class="lnr"> 971 </span>                        }
<span class="lnr"> 972 </span>
<span class="lnr"> 973 </span>                        <span class="Statement">return</span> sSelectedRevNo;
<span class="lnr"> 974 </span>                }
<span class="lnr"> 975 </span>
<span class="lnr"> 976 </span>                <span class="Type">private</span> <span class="Type">void</span> IssueManager_ResizeEnd(<span class="Type">object</span> sender, EventArgs e)
<span class="lnr"> 977 </span>                {
<span class="lnr"> 978 </span>                        dataGridView_LineData.Width = <span class="Statement">this</span>.Size.Width - dataGridView_LineData.Left - <span class="Constant">20</span>;
<span class="lnr"> 979 </span>                }
<span class="lnr"> 980 </span>
<span class="lnr"> 981 </span>                <span class="Comment">///</span><span class="Comment"> </span><span class="Identifier">&lt;</span><span class="Statement">summary</span><span class="Identifier">&gt;</span>
<span class="lnr"> 982 </span>                <span class="Comment">///</span><span class="Comment"> </span>
<span class="lnr"> 983 </span>                <span class="Comment">///</span><span class="Comment"> </span><span class="Identifier">&lt;/</span><span class="Statement">summary</span><span class="Identifier">&gt;</span>
<span class="lnr"> 984 </span>                <span class="Comment">///</span><span class="Comment"> </span><span class="Identifier">&lt;</span><span class="Statement">param</span><span class="Identifier"> </span><span class="Type">name</span>=<span class="Constant">&quot;sender&quot;</span><span class="Identifier">&gt;</span><span class="Identifier">&lt;/</span><span class="Statement">param</span><span class="Identifier">&gt;</span>
<span class="lnr"> 985 </span>                <span class="Comment">///</span><span class="Comment"> </span><span class="Identifier">&lt;</span><span class="Statement">param</span><span class="Identifier"> </span><span class="Type">name</span>=<span class="Constant">&quot;e&quot;</span><span class="Identifier">&gt;</span><span class="Identifier">&lt;/</span><span class="Statement">param</span><span class="Identifier">&gt;</span>
<span class="lnr"> 986 </span>                <span class="Type">private</span> <span class="Type">void</span> IssueManager_SizeChanged(<span class="Type">object</span> sender, EventArgs e)
<span class="lnr"> 987 </span>                {
<span class="lnr"> 988 </span>                        groupBox_Select.Height = <span class="Statement">this</span>.ClientSize.Height - groupBox_Select.Top - <span class="Constant">10</span>;
<span class="lnr"> 989 </span>
<span class="lnr"> 990 </span>                        groupBox_RevisionData.Top = <span class="Statement">this</span>.ClientSize.Height - groupBox_RevisionData.Height - <span class="Constant">10</span>;
<span class="lnr"> 991 </span>                        groupBox_NextGrade.Top = <span class="Statement">this</span>.ClientSize.Height - groupBox_NextGrade.Height - <span class="Constant">10</span>;
<span class="lnr"> 992 </span>                        groupBox_IssueDate.Top = <span class="Statement">this</span>.ClientSize.Height - groupBox_IssueDate.Height - <span class="Constant">10</span>;
<span class="lnr"> 993 </span>                        groupBox_IssueDate.Left = <span class="Statement">this</span>.ClientSize.Width - groupBox_IssueDate.Width - <span class="Constant">10</span>;
<span class="lnr"> 994 </span>                        groupBox_NextGrade.Left = groupBox_IssueDate.Left - groupBox_NextGrade.Width - <span class="Constant">10</span>;
<span class="lnr"> 995 </span>                        groupBox_RevisionData.Width = groupBox_NextGrade.Left - groupBox_RevisionData.Left - <span class="Constant">10</span>;
<span class="lnr"> 996 </span>                        dataGridView_RevisionData.Width = groupBox_RevisionData.Width - <span class="Constant">15</span>;
<span class="lnr"> 997 </span>                }
<span class="lnr"> 998 </span>
<span class="lnr"> 999 </span>                <span class="Comment">/*</span>
<span class="lnr">1000 </span><span class="Comment">                 *      @brief</span>
<span class="lnr">1001 </span><span class="Comment">                 *      </span>
<span class="lnr">1002 </span><span class="Comment">                 *      @author HumKyung</span>
<span class="lnr">1003 </span><span class="Comment">                 *      </span>
<span class="lnr">1004 </span><span class="Comment">                 *      @date   2011.02.15</span>
<span class="lnr">1005 </span><span class="Comment">                 *</span>
<span class="lnr">1006 </span><span class="Comment">                 *      @param  sender</span>
<span class="lnr">1007 </span><span class="Comment">                 *      @param  e</span>
<span class="lnr">1008 </span><span class="Comment">                 *      </span>
<span class="lnr">1009 </span><span class="Comment">                 *      @return</span>
<span class="lnr">1010 </span><span class="Comment">                 */</span>
<span class="lnr">1011 </span>                <span class="Type">private</span> <span class="Type">void</span> listView_GRADE_SelectedIndexChanged(<span class="Type">object</span> sender, EventArgs e)
<span class="lnr">1012 </span>                {
<span class="lnr">1013 </span>                        <span class="Statement">if</span> (<span class="Constant">1</span> == listView_GRADE.SelectedIndices.Count)
<span class="lnr">1014 </span>                        {
<span class="lnr">1015 </span>                                <span class="Type">string</span> sSelItemText = listView_GRADE.Items[listView_GRADE.SelectedIndices[<span class="Constant">0</span>]].SubItems[<span class="Constant">0</span>].Text;
<span class="lnr">1016 </span>                                groupBox_NextGrade.Text = <span class="Constant">&quot;Next grade(&quot;</span> + sSelItemText + <span class="Constant">&quot;)&quot;</span>;
<span class="lnr">1017 </span>                        }
<span class="lnr">1018 </span>                }
<span class="lnr">1019 </span>
<span class="lnr">1020 </span>                <span class="Comment">/*</span>
<span class="lnr">1021 </span><span class="Comment">                 *      @brief</span>
<span class="lnr">1022 </span><span class="Comment">                 *      </span>
<span class="lnr">1023 </span><span class="Comment">                 *      @author HumKyung</span>
<span class="lnr">1024 </span><span class="Comment">                 *      </span>
<span class="lnr">1025 </span><span class="Comment">                 *      @date   2011.02.15</span>
<span class="lnr">1026 </span><span class="Comment">                 *</span>
<span class="lnr">1027 </span><span class="Comment">                 *      @param  sender</span>
<span class="lnr">1028 </span><span class="Comment">                 *      @param  e</span>
<span class="lnr">1029 </span><span class="Comment">                 *      </span>
<span class="lnr">1030 </span><span class="Comment">                 *      @return</span>
<span class="lnr">1031 </span><span class="Comment">                 */</span>
<span class="lnr">1032 </span>                <span class="Type">private</span> <span class="Type">void</span> listView_ISSUE_DATE_MouseDoubleClick(<span class="Type">object</span> sender, MouseEventArgs e)
<span class="lnr">1033 </span>                {
<span class="lnr">1034 </span>                        <span class="Statement">if</span> (chkINSERT.Checked == <span class="Constant">false</span>) <span class="Statement">return</span>;
<span class="lnr">1035 </span>                        <span class="Statement">if</span> ((<span class="Constant">1</span> == listView_GRADE.SelectedItems.Count) &amp;&amp; (<span class="Constant">1</span> == listView_ISSUE_DATE.SelectedItems.Count))
<span class="lnr">1036 </span>                        {
<span class="lnr">1037 </span>                                Insert_RevisionData(chkALL.Checked);
<span class="lnr">1038 </span>                        }
<span class="lnr">1039 </span>                }
<span class="lnr">1040 </span>
<span class="lnr">1041 </span>                <span class="Type">private</span> <span class="Type">void</span> dataGridView_LineData_CellContentDoubleClick(<span class="Type">object</span> sender, DataGridViewCellEventArgs e)
<span class="lnr">1042 </span>                {
<span class="lnr">1043 </span>                        <span class="Type">string</span> sKey = dataGridView_LineData.Rows[e.RowIndex].Cells[<span class="Constant">0</span>].Value.ToString();
<span class="lnr">1044 </span>                        <span class="Type">string</span> sQuery = <span class="Constant">&quot;SELECT * FROM T_ISSUED_REVISION WHERE C_KEY='&quot;</span> + sKey + <span class="Constant">&quot;'&quot;</span>;
<span class="lnr">1045 </span>                        GetDataSetFrom(sQuery, <span class="Constant">false</span>);
<span class="lnr">1046 </span>                        bindingSource1.DataSource = m_table;
<span class="lnr">1047 </span>                        dataGridView_RevisionData.DataSource = m_table;
<span class="lnr">1048 </span>                        <span class="Comment">// Resize the DataGridView columns to fit the newly loaded content.</span>
<span class="lnr">1049 </span>                        dataGridView_RevisionData.AutoResizeColumns(DataGridViewAutoSizeColumnsMode.AllCells);
<span class="lnr">1050 </span>                }
<span class="lnr">1051 </span>
<span class="lnr">1052 </span>                <span class="Comment">///</span><span class="Identifier">&lt;</span><span class="Statement">summary</span><span class="Identifier">&gt;</span>
<span class="lnr">1053 </span>                <span class="Comment">///</span><span class="Comment">KEY값을 가진 ISSUED REVISION DATA를 표시한다.</span>
<span class="lnr">1054 </span>                <span class="Comment">///</span><span class="Identifier">&lt;/</span><span class="Statement">summary</span><span class="Identifier">&gt;</span>
<span class="lnr">1055 </span>                <span class="Comment">///</span><span class="Identifier">&lt;</span><span class="Identifier">date</span><span class="Identifier">&gt;</span><span class="Comment">2011.02.18</span><span class="Identifier">&lt;/date&gt;</span>
<span class="lnr">1056 </span>                <span class="Comment">///</span><span class="Identifier">&lt;</span><span class="Statement">param</span><span class="Identifier"> </span><span class="Type">name</span>=<span class="Constant">&quot;sender&quot;</span><span class="Identifier"> /&gt;</span>
<span class="lnr">1057 </span>                <span class="Comment">///</span><span class="Identifier">&lt;</span><span class="Statement">param</span><span class="Identifier"> </span><span class="Type">name</span>=<span class="Constant">&quot;e&quot;</span><span class="Identifier"> /&gt;</span>
<span class="lnr">1058 </span>                <span class="Type">private</span> <span class="Type">void</span> dataGridView_LineData_CurrentCellChanged(<span class="Type">object</span> sender, EventArgs e)
<span class="lnr">1059 </span>                {
<span class="lnr">1060 </span>                        <span class="Statement">if</span> (<span class="Constant">null</span> != dataGridView_LineData.CurrentCell)
<span class="lnr">1061 </span>                        {
<span class="lnr">1062 </span>                                <span class="Type">int</span> iRowIndex = dataGridView_LineData.CurrentCell.RowIndex;
<span class="lnr">1063 </span>                                <span class="Statement">if</span> (m_iCurRowIndex != iRowIndex)
<span class="lnr">1064 </span>                                {
<span class="lnr">1065 </span>                                        BusinessLogic.m_sKey = dataGridView_LineData.Rows[iRowIndex].Cells[<span class="Constant">1</span>].Value.ToString();
<span class="lnr">1066 </span>                                        <span class="Type">string</span> sQuery = <span class="Constant">&quot;SELECT * FROM T_ISSUED_REVISION WHERE C_KEY='&quot;</span> + BusinessLogic.m_sKey + <span class="Constant">&quot;'&quot;</span>;
<span class="lnr">1067 </span>                                        GetDataSetFrom(sQuery, <span class="Constant">false</span>);
<span class="lnr">1068 </span>                                        bindingSource1.DataSource = m_table;
<span class="lnr">1069 </span>                                        dataGridView_RevisionData.DataSource = m_table;
<span class="lnr">1070 </span>                                        <span class="Comment">// Resize the DataGridView columns to fit the newly loaded content.</span>
<span class="lnr">1071 </span>                                        dataGridView_RevisionData.AutoResizeColumns(DataGridViewAutoSizeColumnsMode.AllCells);
<span class="lnr">1072 </span>
<span class="lnr">1073 </span>                                        m_iCurRowIndex = iRowIndex;
<span class="lnr">1074 </span>
<span class="lnr">1075 </span>                                        <span class="Comment">//! 2011.02.24 added by HumKyung</span>
<span class="lnr">1076 </span>                                        <span class="Statement">foreach</span> (DataRow dr <span class="Statement">in</span> m_table.Rows)
<span class="lnr">1077 </span>                                        {
<span class="lnr">1078 </span>                                                <span class="Type">int</span> iGrade = Convert.ToInt32(dr[<span class="Constant">&quot;C_GRADE&quot;</span>].ToString()) / <span class="Constant">100</span>;
<span class="lnr">1079 </span>                                                dr[<span class="Constant">&quot;C_GRADE&quot;</span>] = iGrade.ToString();
<span class="lnr">1080 </span>                                                <span class="Type">int</span> iRevNo = Convert.ToInt32(dr[<span class="Constant">&quot;C_REV_NO&quot;</span>].ToString());
<span class="lnr">1081 </span>                                                <span class="Statement">foreach</span> (RevisionStage rs <span class="Statement">in</span> BusinessLogic.m_RevisionStageList)
<span class="lnr">1082 </span>                                                {
<span class="lnr">1083 </span>                                                        <span class="Statement">if</span> (iRevNo == rs.m_lNo)
<span class="lnr">1084 </span>                                                        {
<span class="lnr">1085 </span>                                                                dr[<span class="Constant">&quot;C_REV_NO&quot;</span>] = rs.m_sDefine + rs.m_sText;
<span class="lnr">1086 </span>                                                                <span class="Statement">break</span>;
<span class="lnr">1087 </span>                                                        }
<span class="lnr">1088 </span>                                                }
<span class="lnr">1089 </span>                                        }
<span class="lnr">1090 </span>
<span class="lnr">1091 </span>                                        <span class="Comment">//! 2011.02.19 added by HumKyung</span>
<span class="lnr">1092 </span>                                        <span class="Statement">for</span> (<span class="Type">int</span> i = <span class="Constant">0</span>; i &lt; dataGridView_RevisionData.Columns.Count; i++)
<span class="lnr">1093 </span>                                        {
<span class="lnr">1094 </span>                                                dataGridView_RevisionData.Columns[i].ReadOnly = <span class="Constant">true</span>;
<span class="lnr">1095 </span>                                        }
<span class="lnr">1096 </span>                                }
<span class="lnr">1097 </span>                        }
<span class="lnr">1098 </span>                }
<span class="lnr">1099 </span>
<span class="lnr">1100 </span>                <span class="Comment">/*</span>
<span class="lnr">1101 </span><span class="Comment">                 *      @brief Selected Rows Delete from T_ISSUED_LINE_DATA</span>
<span class="lnr">1102 </span><span class="Comment">                 *      </span>
<span class="lnr">1103 </span><span class="Comment">                 *      @author Kyoungmin</span>
<span class="lnr">1104 </span><span class="Comment">                 *      </span>
<span class="lnr">1105 </span><span class="Comment">                 *      @date   2011.02.18</span>
<span class="lnr">1106 </span><span class="Comment">                 *</span>
<span class="lnr">1107 </span><span class="Comment">                 *      @param  sender</span>
<span class="lnr">1108 </span><span class="Comment">                 *      @param  e</span>
<span class="lnr">1109 </span><span class="Comment">                 *      </span>
<span class="lnr">1110 </span><span class="Comment">                 *      @return</span>
<span class="lnr">1111 </span><span class="Comment">                 */</span>
<span class="lnr">1112 </span>                <span class="Type">private</span> <span class="Type">void</span> btnDelete_Click(<span class="Type">object</span> sender, EventArgs e)
<span class="lnr">1113 </span>                {
<span class="lnr">1114 </span>                        <span class="Statement">if</span> (DialogResult.No == MessageBox.Show(<span class="Constant">&quot;Do you want to delete?&quot;</span>, <span class="Constant">&quot;Main Data&quot;</span>, MessageBoxButtons.YesNo, MessageBoxIcon.Question))
<span class="lnr">1115 </span>                        {
<span class="lnr">1116 </span>                                <span class="Statement">return</span>;
<span class="lnr">1117 </span>                        }
<span class="lnr">1118 </span>
<span class="lnr">1119 </span>                        <span class="Type">int</span> nCnt = dataGridView_LineData.SelectedRows.Count;
<span class="lnr">1120 </span>                        <span class="Statement">if</span> (<span class="Constant">0</span> == nCnt)
<span class="lnr">1121 </span>                        {
<span class="lnr">1122 </span>                                MessageBox.Show(<span class="Constant">&quot;At least select 1 Row.&quot;</span>);
<span class="lnr">1123 </span>                                <span class="Statement">return</span>;
<span class="lnr">1124 </span>                        }
<span class="lnr">1125 </span>
<span class="lnr">1126 </span>                        List&lt;<span class="Type">string</span>&gt; columnNameList = <span class="Statement">new</span> List&lt;<span class="Type">string</span>&gt; { };
<span class="lnr">1127 </span>
<span class="lnr">1128 </span>                        <span class="Type">object</span> obj = <span class="Statement">new</span> <span class="Type">object</span> { };
<span class="lnr">1129 </span>                        <span class="Statement">foreach</span> (DataGridViewColumn dc <span class="Statement">in</span> dataGridView_LineData.Columns)
<span class="lnr">1130 </span>                        {
<span class="lnr">1131 </span>                                columnNameList.Add(dc.Name.ToString());
<span class="lnr">1132 </span>                        }
<span class="lnr">1133 </span>
<span class="lnr">1134 </span>                        <span class="Statement">try</span>
<span class="lnr">1135 </span>                        {
<span class="lnr">1136 </span>                                <span class="Type">string</span> sConnection = <span class="Constant">&quot;Provider=Microsoft.Jet.OLEDB.4.0;Data Source=&quot;</span> + BusinessLogic.DatabasePath;
<span class="lnr">1137 </span>                                m_connection.Open(sConnection, <span class="Constant">null</span>, <span class="Constant">null</span>, <span class="Constant">0</span>);
<span class="lnr">1138 </span>
<span class="lnr">1139 </span>                                <span class="Type">string</span> sCondition = <span class="Type">string</span>.Empty;
<span class="lnr">1140 </span>
<span class="lnr">1141 </span>                                <span class="Statement">foreach</span> (DataGridViewRow dr <span class="Statement">in</span> dataGridView_LineData.SelectedRows)
<span class="lnr">1142 </span>                                {
<span class="lnr">1143 </span>                                        <span class="Type">int</span> i = <span class="Constant">0</span>;
<span class="lnr">1144 </span>                                        <span class="Statement">foreach</span> (DataGridViewCell dc <span class="Statement">in</span> dr.Cells)
<span class="lnr">1145 </span>                                        {
<span class="lnr">1146 </span>                                                <span class="Statement">if</span> (<span class="Constant">&quot;C_KEY&quot;</span> == columnNameList[i])
<span class="lnr">1147 </span>                                                {
<span class="lnr">1148 </span>                                                        sCondition = dc.Value.ToString();
<span class="lnr">1149 </span>                                                        <span class="Statement">break</span>;
<span class="lnr">1150 </span>                                                }
<span class="lnr">1151 </span>                                                i++;
<span class="lnr">1152 </span>                                        }
<span class="lnr">1153 </span>
<span class="lnr">1154 </span>                                        <span class="Comment">///</span><span class="Comment">! T_ISSUED_LINE_DATA Delete</span>
<span class="lnr">1155 </span>                                        <span class="Type">string</span> sCommand = <span class="Constant">&quot;DELETE * FROM T_ISSUED_LINE_DATA &quot;</span> + <span class="Constant">&quot; WHERE C_KEY='&quot;</span> + sCondition + <span class="Constant">&quot;'&quot;</span>;
<span class="lnr">1156 </span>                                        <span class="Statement">try</span>
<span class="lnr">1157 </span>                                        {
<span class="lnr">1158 </span>                                                m_connection.Execute(sCommand, <span class="Statement">out</span> obj, <span class="Constant">0</span>);
<span class="lnr">1159 </span>                                        }
<span class="lnr">1160 </span>                                        <span class="Statement">catch</span> (OleDbException ex)
<span class="lnr">1161 </span>                                        {
<span class="lnr">1162 </span>                                                MessageBox.Show(ex.Errors.ToString());
<span class="lnr">1163 </span>                                        }
<span class="lnr">1164 </span>
<span class="lnr">1165 </span>                                        <span class="Comment">///</span><span class="Comment">! T_ISSUED_REVISION Delete</span>
<span class="lnr">1166 </span>                                        sCommand = <span class="Constant">&quot;DELETE * FROM T_ISSUED_REVISION &quot;</span> + <span class="Constant">&quot; WHERE C_KEY='&quot;</span> + sCondition + <span class="Constant">&quot;'&quot;</span>;
<span class="lnr">1167 </span>                                        <span class="Statement">try</span>
<span class="lnr">1168 </span>                                        {
<span class="lnr">1169 </span>                                                m_connection.Execute(sCommand, <span class="Statement">out</span> obj, <span class="Constant">0</span>);
<span class="lnr">1170 </span>                                        }
<span class="lnr">1171 </span>                                        <span class="Statement">catch</span> (OleDbException ex)
<span class="lnr">1172 </span>                                        {
<span class="lnr">1173 </span>                                                MessageBox.Show(ex.Errors.ToString());
<span class="lnr">1174 </span>                                        }
<span class="lnr">1175 </span>                                }
<span class="lnr">1176 </span>                                m_connection.Close();
<span class="lnr">1177 </span>
<span class="lnr">1178 </span>                                <span class="Comment">///</span><span class="Comment">! display data set</span>
<span class="lnr">1179 </span>                                {
<span class="lnr">1180 </span>                                        GetDataSetFrom(<span class="Constant">&quot;SELECT * FROM T_ISSUED_LINE_DATA&quot;</span>, <span class="Constant">true</span>);
<span class="lnr">1181 </span>                                        bindingSource1.DataSource = m_table;
<span class="lnr">1182 </span>                                        <span class="Comment">///</span><span class="Comment">! DataColumn oColumn </span>=<span class="Comment"> new DataColumn();</span>
<span class="lnr">1183 </span>                                        <span class="Comment">///</span><span class="Comment">! m_table.Columns.Add(&quot;C&quot;, typeof(System.Boolean));</span>
<span class="lnr">1184 </span>                                        dataGridView_LineData.DataSource = m_table;
<span class="lnr">1185 </span>                                        <span class="Comment">///</span><span class="Comment">! Resize the DataGridView columns to fit the newly loaded content.</span>
<span class="lnr">1186 </span>                                        dataGridView_LineData.AutoResizeColumns(DataGridViewAutoSizeColumnsMode.AllCells);
<span class="lnr">1187 </span>
<span class="lnr">1188 </span>                                        <span class="Statement">for</span> (<span class="Type">int</span> i = <span class="Constant">1</span>; i &lt; dataGridView_LineData.Columns.Count; ++i)
<span class="lnr">1189 </span>                                        {
<span class="lnr">1190 </span>                                                dataGridView_LineData.Columns[i].ReadOnly = <span class="Constant">true</span>;
<span class="lnr">1191 </span>                                        }
<span class="lnr">1192 </span>
<span class="lnr">1193 </span>                                        <span class="Type">int</span> iCancellationCount = <span class="Constant">0</span>;
<span class="lnr">1194 </span>                                        <span class="Statement">for</span> (<span class="Type">int</span> i = <span class="Constant">0</span>; i &lt; dataGridView_LineData.Rows.Count; ++i)
<span class="lnr">1195 </span>                                        {
<span class="lnr">1196 </span>                                                dataGridView_LineData.Rows[i].Cells[<span class="Constant">0</span>].Value = dataGridView_LineData.Rows[i].Cells[<span class="Constant">&quot;C_CANCELLATION&quot;</span>].Value;
<span class="lnr">1197 </span>                                                <span class="Type">object</span> oValue = dataGridView_LineData.Rows[i].Cells[<span class="Constant">0</span>].Value;
<span class="lnr">1198 </span>                                                <span class="Statement">if</span> ((<span class="Constant">null</span> != oValue) &amp;&amp; (<span class="Type">string</span>.Empty != oValue.ToString()) &amp;&amp; (<span class="Constant">true</span> == Convert.ToBoolean(oValue)))
<span class="lnr">1199 </span>                                                {
<span class="lnr">1200 </span>                                                        Font oFont = <span class="Statement">new</span> Font(dataGridView_LineData.Font, FontStyle.Strikeout);
<span class="lnr">1201 </span>                                                        <span class="Statement">for</span> (<span class="Type">int</span> j = <span class="Constant">1</span>; j &lt; dataGridView_LineData.Columns.Count; ++j)
<span class="lnr">1202 </span>                                                        {
<span class="lnr">1203 </span>                                                                dataGridView_LineData.Rows[i].Cells[j].Style.ForeColor = Color.FromArgb(<span class="Constant">255</span>, <span class="Constant">0</span>, <span class="Constant">0</span>);
<span class="lnr">1204 </span>                                                                dataGridView_LineData.Rows[i].Cells[j].Style.Font = oFont;
<span class="lnr">1205 </span>                                                        }
<span class="lnr">1206 </span>                                                        ++iCancellationCount;
<span class="lnr">1207 </span>                                                }
<span class="lnr">1208 </span>                                        }
<span class="lnr">1209 </span>                                        dataGridView_LineData.Columns[<span class="Constant">0</span>].Width = <span class="Constant">20</span>;
<span class="lnr">1210 </span>                                }
<span class="lnr">1211 </span>                        }
<span class="lnr">1212 </span>                        <span class="Statement">catch</span>(Exception ex)
<span class="lnr">1213 </span>                        {
<span class="lnr">1214 </span>                                MessageBox.Show(ex.Message);
<span class="lnr">1215 </span>                        }
<span class="lnr">1216 </span>                }
<span class="lnr">1217 </span>
<span class="lnr">1218 </span>                <span class="Comment">/*</span>
<span class="lnr">1219 </span><span class="Comment">                 *      @brief Selected Rows Delete from T_ISSUED_REVISION</span>
<span class="lnr">1220 </span><span class="Comment">                 *      </span>
<span class="lnr">1221 </span><span class="Comment">                 *      @author Kyoungmin</span>
<span class="lnr">1222 </span><span class="Comment">                 *      </span>
<span class="lnr">1223 </span><span class="Comment">                 *      @date   2011.02.18</span>
<span class="lnr">1224 </span><span class="Comment">                 *</span>
<span class="lnr">1225 </span><span class="Comment">                 *      @param  sender</span>
<span class="lnr">1226 </span><span class="Comment">                 *      @param  e</span>
<span class="lnr">1227 </span><span class="Comment">                 *      </span>
<span class="lnr">1228 </span><span class="Comment">                 *      @return</span>
<span class="lnr">1229 </span><span class="Comment">                 */</span>
<span class="lnr">1230 </span>                <span class="Type">private</span> <span class="Type">void</span> btnRevDelete_Click(<span class="Type">object</span> sender, EventArgs e)
<span class="lnr">1231 </span>                {
<span class="lnr">1232 </span>                        <span class="Type">string</span> sRes = MessageBox.Show(<span class="Constant">&quot;Do you want to delete?&quot;</span>, <span class="Constant">&quot;Revision Data&quot;</span>, MessageBoxButtons.YesNo, MessageBoxIcon.Question).ToString();
<span class="lnr">1233 </span>                        <span class="Statement">if</span> (<span class="Constant">&quot;No&quot;</span> == sRes) <span class="Statement">return</span>;
<span class="lnr">1234 </span>
<span class="lnr">1235 </span>                        <span class="Type">int</span> nCnt = dataGridView_RevisionData.SelectedRows.Count;
<span class="lnr">1236 </span>                        <span class="Statement">if</span> (<span class="Constant">0</span> == nCnt)
<span class="lnr">1237 </span>                        {
<span class="lnr">1238 </span>                                MessageBox.Show(<span class="Constant">&quot;At least select 1 Row.&quot;</span>);
<span class="lnr">1239 </span>                                <span class="Statement">return</span>;
<span class="lnr">1240 </span>                        }
<span class="lnr">1241 </span>
<span class="lnr">1242 </span>                        List&lt;<span class="Type">string</span>&gt; columnNameList = <span class="Statement">new</span> List&lt;<span class="Type">string</span>&gt; { };
<span class="lnr">1243 </span>                        <span class="Type">object</span> obj = <span class="Statement">new</span> <span class="Type">object</span> { };
<span class="lnr">1244 </span>
<span class="lnr">1245 </span>                        <span class="Statement">foreach</span> (DataGridViewColumn dc <span class="Statement">in</span> dataGridView_RevisionData.Columns)
<span class="lnr">1246 </span>                        {
<span class="lnr">1247 </span>                                columnNameList.Add(dc.Name.ToString());
<span class="lnr">1248 </span>                        }
<span class="lnr">1249 </span>
<span class="lnr">1250 </span>                        <span class="Type">string</span> sConnection = <span class="Constant">&quot;Provider=Microsoft.Jet.OLEDB.4.0;Data Source=&quot;</span> + BusinessLogic.DatabasePath;
<span class="lnr">1251 </span>                        <span class="Type">string</span> sCondition = <span class="Type">string</span>.Empty;
<span class="lnr">1252 </span>                        <span class="Type">string</span> sKey = <span class="Type">string</span>.Empty;
<span class="lnr">1253 </span>
<span class="lnr">1254 </span>                        m_connection.Open(sConnection, <span class="Constant">null</span>, <span class="Constant">null</span>, <span class="Constant">0</span>);
<span class="lnr">1255 </span>                        <span class="Statement">foreach</span> (DataGridViewRow dr <span class="Statement">in</span> dataGridView_RevisionData.SelectedRows)
<span class="lnr">1256 </span>                        {
<span class="lnr">1257 </span>                                <span class="Type">int</span> i = <span class="Constant">0</span>;
<span class="lnr">1258 </span>                                <span class="Statement">foreach</span> (DataGridViewCell dc <span class="Statement">in</span> dr.Cells)
<span class="lnr">1259 </span>                                {
<span class="lnr">1260 </span>                                        <span class="Statement">if</span> (<span class="Constant">&quot;C_KEY&quot;</span> == columnNameList[i])
<span class="lnr">1261 </span>                                        {
<span class="lnr">1262 </span>                                                sKey = <span class="Constant">&quot;C_KEY='&quot;</span> + dc.Value + <span class="Constant">&quot;'&quot;</span>;
<span class="lnr">1263 </span>                                        }
<span class="lnr">1264 </span>                                        <span class="Statement">if</span> (<span class="Constant">&quot;C_REV_NO&quot;</span> == columnNameList[i])
<span class="lnr">1265 </span>                                        {
<span class="lnr">1266 </span>                                                sCondition = <span class="Constant">&quot;C_REV_NO='&quot;</span> + dc.Value + <span class="Constant">&quot;'&quot;</span>;
<span class="lnr">1267 </span>                                        }
<span class="lnr">1268 </span>                                        i++;
<span class="lnr">1269 </span>                                }
<span class="lnr">1270 </span>
<span class="lnr">1271 </span>                                <span class="Type">string</span> sCommand = <span class="Constant">&quot;DELETE * FROM T_ISSUED_REVISION &quot;</span> + <span class="Constant">&quot; WHERE &quot;</span> + sCondition + <span class="Constant">&quot; AND &quot;</span> + sKey;
<span class="lnr">1272 </span>                                <span class="Statement">try</span>
<span class="lnr">1273 </span>                                {
<span class="lnr">1274 </span>                                        m_connection.Execute(sCommand, <span class="Statement">out</span> obj, <span class="Constant">0</span>);
<span class="lnr">1275 </span>                                }
<span class="lnr">1276 </span>                                <span class="Statement">catch</span> (OleDbException ex)
<span class="lnr">1277 </span>                                {
<span class="lnr">1278 </span>                                        MessageBox.Show(ex.Errors.ToString());
<span class="lnr">1279 </span>                                }
<span class="lnr">1280 </span>                        }
<span class="lnr">1281 </span>                        m_connection.Close();
<span class="lnr">1282 </span>
<span class="lnr">1283 </span>                        <span class="Type">string</span> sQuery = <span class="Constant">&quot;SELECT * FROM T_ISSUED_REVISION WHERE &quot;</span> + sKey;
<span class="lnr">1284 </span>                        GetDataSetFrom(sQuery, <span class="Constant">false</span>);
<span class="lnr">1285 </span>                        bindingSource1.DataSource = m_table;
<span class="lnr">1286 </span>                        dataGridView_RevisionData.DataSource = m_table;
<span class="lnr">1287 </span>                        <span class="Comment">// Resize the DataGridView columns to fit the newly loaded content.</span>
<span class="lnr">1288 </span>                        dataGridView_RevisionData.AutoResizeColumns(DataGridViewAutoSizeColumnsMode.AllCells);
<span class="lnr">1289 </span>                }
<span class="lnr">1290 </span>
<span class="lnr">1291 </span>                <span class="Type">private</span> <span class="Type">void</span> chkModify_CheckedChanged(<span class="Type">object</span> sender, EventArgs e)
<span class="lnr">1292 </span>                {
<span class="lnr">1293 </span>                        <span class="Statement">if</span> (chkModify.Checked == <span class="Constant">true</span>)
<span class="lnr">1294 </span>                        {
<span class="lnr">1295 </span>                                <span class="Statement">for</span> (<span class="Type">int</span> i = <span class="Constant">1</span>; i &lt; dataGridView_LineData.Columns.Count; i++)
<span class="lnr">1296 </span>                                {
<span class="lnr">1297 </span>                                        dataGridView_LineData.Columns[i].ReadOnly = <span class="Constant">false</span>;
<span class="lnr">1298 </span>                                }
<span class="lnr">1299 </span>                        }
<span class="lnr">1300 </span>                        <span class="Statement">else</span>
<span class="lnr">1301 </span>                        {
<span class="lnr">1302 </span>                                <span class="Statement">for</span> (<span class="Type">int</span> i = <span class="Constant">1</span>; i &lt; dataGridView_LineData.Columns.Count; i++)
<span class="lnr">1303 </span>                                {
<span class="lnr">1304 </span>                                        dataGridView_LineData.Columns[i].ReadOnly = <span class="Constant">true</span>;
<span class="lnr">1305 </span>                                }
<span class="lnr">1306 </span>                        }
<span class="lnr">1307 </span>                }
<span class="lnr">1308 </span>
<span class="lnr">1309 </span>                <span class="Type">private</span> <span class="Type">void</span> chkGrade_CheckedChanged(<span class="Type">object</span> sender, EventArgs e)
<span class="lnr">1310 </span>                {
<span class="lnr">1311 </span>                        lvwGRADE.Enabled = chkGrade.Checked;
<span class="lnr">1312 </span>                        <span class="Statement">if</span> (chkGrade.Checked &amp;&amp; chkREV.Checked &amp;&amp; checkBox_ISSUE_DATE.Checked)
<span class="lnr">1313 </span>                        {
<span class="lnr">1314 </span>                                chkALL.Enabled = <span class="Constant">true</span>;
<span class="lnr">1315 </span>                        }
<span class="lnr">1316 </span>                        <span class="Statement">else</span>
<span class="lnr">1317 </span>                        {
<span class="lnr">1318 </span>                                chkALL.Enabled = <span class="Constant">false</span>;
<span class="lnr">1319 </span>                        }
<span class="lnr">1320 </span>                }
<span class="lnr">1321 </span>
<span class="lnr">1322 </span>                <span class="Type">private</span> <span class="Type">void</span> chkREV_CheckedChanged(<span class="Type">object</span> sender, EventArgs e)
<span class="lnr">1323 </span>                {
<span class="lnr">1324 </span>                        lvwREV.Enabled = chkREV.Checked;
<span class="lnr">1325 </span>                        <span class="Statement">if</span> (chkGrade.Checked &amp;&amp; chkREV.Checked &amp;&amp; checkBox_ISSUE_DATE.Checked)
<span class="lnr">1326 </span>                        {
<span class="lnr">1327 </span>                                chkALL.Enabled = <span class="Constant">true</span>;
<span class="lnr">1328 </span>                        }
<span class="lnr">1329 </span>                        <span class="Statement">else</span>
<span class="lnr">1330 </span>                        {
<span class="lnr">1331 </span>                                chkALL.Enabled = <span class="Constant">false</span>;
<span class="lnr">1332 </span>                        }
<span class="lnr">1333 </span>                }
<span class="lnr">1334 </span>
<span class="lnr">1335 </span>                <span class="Type">private</span> <span class="Type">void</span> Insert_RevisionData(<span class="Type">bool</span> bCheckAll)
<span class="lnr">1336 </span>                {
<span class="lnr">1337 </span>                        <span class="Type">int</span> index = Application.ExecutablePath.LastIndexOf(<span class="Constant">&quot;</span><span class="Special">\\</span><span class="Constant">&quot;</span>);
<span class="lnr">1338 </span>                        <span class="Type">string</span> sLogPath = Application.ExecutablePath.Substring(<span class="Constant">0</span>, index) + <span class="Constant">&quot;</span><span class="Special">\\</span><span class="Constant">Loglist.txt&quot;</span>;
<span class="lnr">1339 </span>                        <span class="Type">string</span>[] sLogList;
<span class="lnr">1340 </span>                        <span class="Type">string</span> sLogTmp = <span class="Constant">&quot;&quot;</span>;
<span class="lnr">1341 </span>                        <span class="Type">int</span> nLogCnt = <span class="Constant">0</span>;
<span class="lnr">1342 </span>
<span class="lnr">1343 </span>                        <span class="Type">string</span>[] sKey;
<span class="lnr">1344 </span>                        <span class="Statement">if</span> (bCheckAll &amp;&amp; chkALL.Enabled)
<span class="lnr">1345 </span>                        {
<span class="lnr">1346 </span>                                sKey = <span class="Statement">new</span> <span class="Type">string</span>[dataGridView_LineData.Rows.Count];
<span class="lnr">1347 </span>                                <span class="Statement">for</span> (<span class="Type">int</span> i = <span class="Constant">0</span>; i &lt; dataGridView_LineData.Rows.Count; i++)
<span class="lnr">1348 </span>                                {
<span class="lnr">1349 </span>                                        sKey[i] = dataGridView_LineData[<span class="Constant">0</span>, i].Value.ToString();
<span class="lnr">1350 </span>                                }
<span class="lnr">1351 </span>                        }
<span class="lnr">1352 </span>                        <span class="Statement">else</span>
<span class="lnr">1353 </span>                        {
<span class="lnr">1354 </span>                                sKey = <span class="Statement">new</span> <span class="Type">string</span>[<span class="Constant">1</span>];
<span class="lnr">1355 </span>                                sKey[<span class="Constant">0</span>] = BusinessLogic.m_sKey;
<span class="lnr">1356 </span>                        }
<span class="lnr">1357 </span>
<span class="lnr">1358 </span>                        <span class="Statement">for</span> (<span class="Type">int</span> i = <span class="Constant">0</span>; i &lt; sKey.Length; i++)
<span class="lnr">1359 </span>                        {
<span class="lnr">1360 </span>                                <span class="Type">string</span> sSelControlDate = listView_ISSUE_DATE.SelectedItems[<span class="Constant">0</span>].SubItems[<span class="Constant">1</span>].Text;
<span class="lnr">1361 </span>                                <span class="Statement">if</span> (BusinessLogic.IsBeforeCurrentDate(sSelControlDate))
<span class="lnr">1362 </span>                                {
<span class="lnr">1363 </span>                                        <span class="Comment">//MessageBox.Show(&quot;날짜가 지났습니다.&quot;, &quot;에러&quot;);</span>
<span class="lnr">1364 </span>                                        sLogTmp += sKey[i] + <span class="Constant">&quot; 날짜가 지났습니다.&quot;</span> + <span class="Constant">&quot;^&quot;</span>;
<span class="lnr">1365 </span>                                        nLogCnt++;
<span class="lnr">1366 </span>                                        <span class="Statement">continue</span>;
<span class="lnr">1367 </span>                                }
<span class="lnr">1368 </span>
<span class="lnr">1369 </span>                                <span class="Type">string</span> sSelGrade = listView_GRADE.SelectedItems[<span class="Constant">0</span>].SubItems[<span class="Constant">0</span>].Text;
<span class="lnr">1370 </span>                                <span class="Type">string</span> sSelGradeDesc = listView_GRADE.SelectedItems[<span class="Constant">0</span>].SubItems[<span class="Constant">1</span>].Text;
<span class="lnr">1371 </span>
<span class="lnr">1372 </span>                                <span class="Type">string</span> sQuery = <span class="Constant">&quot;SELECT C_REV_NO, C_REV_DATE FROM T_ISSUED_REVISION WHERE C_KEY='&quot;</span> + sKey[i] + <span class="Constant">&quot;'&quot;</span>;
<span class="lnr">1373 </span>                                GetDataSetFrom(sQuery, <span class="Constant">false</span>);
<span class="lnr">1374 </span>
<span class="lnr">1375 </span>                                <span class="Type">string</span> sLastRevNo = <span class="Constant">&quot;0&quot;</span>;
<span class="lnr">1376 </span>                                <span class="Type">string</span> sLastRevDate = <span class="Type">string</span>.Empty;
<span class="lnr">1377 </span>                                <span class="Type">string</span> sSelRevDate = listView_ISSUE_DATE.SelectedItems[<span class="Constant">0</span>].SubItems[<span class="Constant">0</span>].Text;
<span class="lnr">1378 </span>
<span class="lnr">1379 </span>                                <span class="Statement">foreach</span> (DataRow dr <span class="Statement">in</span> m_table.Rows)
<span class="lnr">1380 </span>                                {
<span class="lnr">1381 </span>                                        <span class="Statement">if</span> (Convert.ToInt32(sLastRevNo) &lt; Convert.ToInt32(dr[<span class="Constant">0</span>].ToString()))
<span class="lnr">1382 </span>                                        {
<span class="lnr">1383 </span>                                                sLastRevNo = dr[<span class="Constant">0</span>].ToString();  <span class="Comment">//Revision No</span>
<span class="lnr">1384 </span>                                                sLastRevDate = dr[<span class="Constant">1</span>].ToString();<span class="Comment">//Revision No를 기준으로 Revation Date를 가져옴</span>
<span class="lnr">1385 </span>                                        }
<span class="lnr">1386 </span>                                }
<span class="lnr">1387 </span>
<span class="lnr">1388 </span>                                <span class="Statement">if</span> (BusinessLogic.IsBeforeLastRevDate(sLastRevDate, sSelRevDate))
<span class="lnr">1389 </span>                                {
<span class="lnr">1390 </span>                                        <span class="Comment">//MessageBox.Show(&quot;최종 REV. 날짜보다 이전 날짜는 입력할 수 없습니다.&quot;, &quot;에러&quot;);</span>
<span class="lnr">1391 </span>                                        sLogTmp += sKey[i] + <span class="Constant">&quot; 최종 REV. 날짜보다 이전 날짜는 입력할 수 없습니다.&quot;</span> + <span class="Constant">&quot;^&quot;</span>;
<span class="lnr">1392 </span>                                        nLogCnt++;
<span class="lnr">1393 </span>                                        <span class="Statement">continue</span>;
<span class="lnr">1394 </span>                                }
<span class="lnr">1395 </span>
<span class="lnr">1396 </span>                                <span class="Statement">if</span> (!BusinessLogic.CheckSelectedGrade(Convert.ToInt32(sLastRevNo), Convert.ToInt32(sSelGrade)))
<span class="lnr">1397 </span>                                {
<span class="lnr">1398 </span>                                        <span class="Comment">//MessageBox.Show(&quot;Select appropriate grade!!!&quot;);</span>
<span class="lnr">1399 </span>                                        sLogTmp += sKey[i] + <span class="Constant">&quot; Select appropriate grade!!!&quot;</span> + <span class="Constant">&quot;^&quot;</span>;
<span class="lnr">1400 </span>                                        nLogCnt++;
<span class="lnr">1401 </span>                                        <span class="Statement">continue</span>;
<span class="lnr">1402 </span>                                }
<span class="lnr">1403 </span>
<span class="lnr">1404 </span>                                RevisionStage stage = <span class="Statement">new</span> RevisionStage();
<span class="lnr">1405 </span>                                <span class="Statement">if</span> (BusinessLogic.GetNextRevisionStage(<span class="Statement">ref</span> stage, Convert.ToInt32(sLastRevNo), Convert.ToInt32(sSelGrade)))
<span class="lnr">1406 </span>                                {
<span class="lnr">1407 </span>                                        <span class="Type">string</span> sConnection = <span class="Constant">&quot;Provider=Microsoft.Jet.OLEDB.4.0;Data Source=&quot;</span> + BusinessLogic.DatabasePath;
<span class="lnr">1408 </span>                                        <span class="Statement">try</span>
<span class="lnr">1409 </span>                                        {
<span class="lnr">1410 </span>                                                m_connection.Open(sConnection, <span class="Constant">null</span>, <span class="Constant">null</span>, <span class="Constant">0</span>);
<span class="lnr">1411 </span>
<span class="lnr">1412 </span>                                                <span class="Type">string</span> sFields = <span class="Constant">&quot;C_KEY,C_REV_DRWN_BY,C_REV_CHECKED_BY,C_REV_APPROVED_BY,C_REV_DATE,&quot;</span>;
<span class="lnr">1413 </span>                                                sFields += <span class="Constant">&quot;C_GRADE,C_REV_NO,C_REV_CONTROL_WORKING_DATE,C_REV_DESC&quot;</span>;
<span class="lnr">1414 </span>
<span class="lnr">1415 </span>                                                <span class="Type">string</span> sValues = <span class="Constant">&quot;'&quot;</span> + sKey[i] + <span class="Constant">&quot;',&quot;</span>;
<span class="lnr">1416 </span>                                                sValues += <span class="Constant">&quot;'&quot;</span> + BusinessLogic.m_sDrwnBy + <span class="Constant">&quot;',&quot;</span>;
<span class="lnr">1417 </span>                                                sValues += <span class="Constant">&quot;'&quot;</span> + BusinessLogic.m_sCheckedBy + <span class="Constant">&quot;',&quot;</span>;
<span class="lnr">1418 </span>                                                sValues += <span class="Constant">&quot;'&quot;</span> + BusinessLogic.m_sApprovedBy + <span class="Constant">&quot;',&quot;</span>;
<span class="lnr">1419 </span>                                                sValues += <span class="Constant">&quot;'&quot;</span> + sSelRevDate + <span class="Constant">&quot;',&quot;</span>;
<span class="lnr">1420 </span>                                                sValues += <span class="Constant">&quot;'&quot;</span> + sSelGrade + <span class="Constant">&quot;',&quot;</span>;
<span class="lnr">1421 </span>                                                sValues += <span class="Constant">&quot;'&quot;</span> + stage.m_lNo.ToString() + <span class="Constant">&quot;',&quot;</span>;
<span class="lnr">1422 </span>                                                sValues += <span class="Constant">&quot;'&quot;</span> + sSelControlDate + <span class="Constant">&quot;',&quot;</span>;
<span class="lnr">1423 </span>                                                sValues += <span class="Constant">&quot;'&quot;</span> + sSelGradeDesc + <span class="Constant">&quot;'&quot;</span>;
<span class="lnr">1424 </span>
<span class="lnr">1425 </span>                                                <span class="Type">string</span> sCommand = <span class="Constant">&quot;INSERT INTO T_ISSUED_REVISION(&quot;</span> + sFields + <span class="Constant">&quot;) VALUES(&quot;</span> + sValues + <span class="Constant">&quot;)&quot;</span>;
<span class="lnr">1426 </span>                                                <span class="Type">object</span> obj = <span class="Statement">new</span> <span class="Type">object</span>();
<span class="lnr">1427 </span>                                                m_connection.Execute(sCommand, <span class="Statement">out</span> obj, <span class="Constant">0</span>);
<span class="lnr">1428 </span>                                                m_connection.Close();
<span class="lnr">1429 </span>                                        }
<span class="lnr">1430 </span>                                        <span class="Statement">catch</span> (Exception ex)
<span class="lnr">1431 </span>                                        {
<span class="lnr">1432 </span>                                                m_connection.Close();
<span class="lnr">1433 </span>                                                MessageBox.Show(ex.Message.ToString());
<span class="lnr">1434 </span>                                        }
<span class="lnr">1435 </span>                                }
<span class="lnr">1436 </span>                        }
<span class="lnr">1437 </span>                        <span class="Comment">// Revision Data 창 Refresh</span>
<span class="lnr">1438 </span>                        <span class="Type">string</span> sQuery2 = <span class="Constant">&quot;SELECT * FROM T_ISSUED_REVISION WHERE C_KEY='&quot;</span> + BusinessLogic.m_sKey + <span class="Constant">&quot;'&quot;</span>;
<span class="lnr">1439 </span>                        GetDataSetFrom(sQuery2, <span class="Constant">false</span>);
<span class="lnr">1440 </span>                        bindingSource1.DataSource = m_table;
<span class="lnr">1441 </span>                        dataGridView_RevisionData.DataSource = m_table;
<span class="lnr">1442 </span>                        dataGridView_RevisionData.AutoResizeColumns(DataGridViewAutoSizeColumnsMode.AllCells);
<span class="lnr">1443 </span>
<span class="lnr">1444 </span>                        <span class="Statement">for</span> (<span class="Type">int</span> i = <span class="Constant">0</span>; i &lt; dataGridView_RevisionData.Columns.Count; i++)
<span class="lnr">1445 </span>                        {
<span class="lnr">1446 </span>                                dataGridView_RevisionData.Columns[i].ReadOnly = <span class="Constant">true</span>;
<span class="lnr">1447 </span>                        }
<span class="lnr">1448 </span>
<span class="lnr">1449 </span>                        <span class="Comment">// Error List 띄우기</span>
<span class="lnr">1450 </span>                        <span class="Statement">if</span> (<span class="Type">string</span>.Empty != sLogTmp.Trim())
<span class="lnr">1451 </span>                        {
<span class="lnr">1452 </span>                                sLogList = <span class="Statement">new</span> <span class="Type">string</span>[nLogCnt];
<span class="lnr">1453 </span>                                sLogList = sLogTmp.Split(<span class="Statement">new</span> Char[] { <span class="Constant">'^'</span> });
<span class="lnr">1454 </span>                                File.WriteAllLines(sLogPath, sLogList, Encoding.UTF8);
<span class="lnr">1455 </span>                                System.Diagnostics.Process.Start(sLogPath);
<span class="lnr">1456 </span>                        }
<span class="lnr">1457 </span>                }
<span class="lnr">1458 </span>
<span class="lnr">1459 </span>                <span class="Comment">///</span><span class="Comment"> </span><span class="Identifier">&lt;</span><span class="Statement">summary</span><span class="Identifier">&gt;</span>
<span class="lnr">1460 </span>                <span class="Comment">///</span><span class="Comment"> </span>
<span class="lnr">1461 </span>                <span class="Comment">///</span><span class="Comment"> </span><span class="Identifier">&lt;/</span><span class="Statement">summary</span><span class="Identifier">&gt;</span>
<span class="lnr">1462 </span>                <span class="Comment">///</span><span class="Comment"> </span><span class="Identifier">&lt;</span><span class="Statement">param</span><span class="Identifier"> </span><span class="Type">name</span>=<span class="Constant">&quot;sKey&quot;</span><span class="Identifier">&gt;</span><span class="Identifier">&lt;/</span><span class="Statement">param</span><span class="Identifier">&gt;</span>
<span class="lnr">1463 </span>                <span class="Comment">///</span><span class="Comment"> </span><span class="Identifier">&lt;</span><span class="Statement">param</span><span class="Identifier"> </span><span class="Type">name</span>=<span class="Constant">&quot;iRevNo&quot;</span><span class="Identifier">&gt;</span><span class="Comment">get the last revision number if iRevNo is -1</span><span class="Identifier">&lt;/</span><span class="Statement">param</span><span class="Identifier">&gt;</span>
<span class="lnr">1464 </span>                <span class="Comment">///</span><span class="Comment"> </span><span class="Identifier">&lt;</span><span class="Statement">returns</span><span class="Identifier">&gt;</span><span class="Identifier">&lt;/</span><span class="Statement">returns</span><span class="Identifier">&gt;</span>
<span class="lnr">1465 </span>                <span class="Type">private</span> <span class="Type">string</span> GetRevIssueDateAtIndex(<span class="Type">string</span> sKey , <span class="Type">int</span> iRevNo)
<span class="lnr">1466 </span>                {
<span class="lnr">1467 </span>                        <span class="Type">string</span> sIssueDate = <span class="Type">string</span>.Empty;
<span class="lnr">1468 </span>
<span class="lnr">1469 </span>                        <span class="Type">string</span> sConnection = <span class="Constant">&quot;Provider=Microsoft.Jet.OLEDB.4.0;Data Source=&quot;</span> + BusinessLogic.DatabasePath;
<span class="lnr">1470 </span>                        <span class="Type">string</span> sCondition = <span class="Type">string</span>.Empty;
<span class="lnr">1471 </span>
<span class="lnr">1472 </span>                        <span class="Type">string</span> sCommand = <span class="Type">string</span>.Format(<span class="Constant">&quot;SELECT C_REV_DATE FROM T_ISSUED_REVISION WHERE C_KEY='{0}'&quot;</span>, sKey);
<span class="lnr">1473 </span>                        GetDataSetFrom(sCommand, <span class="Constant">false</span>);
<span class="lnr">1474 </span>                        <span class="Statement">if</span> (-<span class="Constant">1</span> != iRevNo)
<span class="lnr">1475 </span>                        {
<span class="lnr">1476 </span>                                <span class="Statement">if</span> (m_table.Rows.Count &gt; iRevNo)
<span class="lnr">1477 </span>                                {
<span class="lnr">1478 </span>                                        sIssueDate = m_table.Rows[iRevNo].ItemArray[<span class="Constant">0</span>].ToString();
<span class="lnr">1479 </span>                                }
<span class="lnr">1480 </span>                        }
<span class="lnr">1481 </span>                        <span class="Statement">else</span>
<span class="lnr">1482 </span>                        {
<span class="lnr">1483 </span>                                sIssueDate = m_table.Rows[m_table.Rows.Count - <span class="Constant">1</span>].ItemArray[<span class="Constant">0</span>].ToString();
<span class="lnr">1484 </span>                        }
<span class="lnr">1485 </span>
<span class="lnr">1486 </span>                        <span class="Statement">return</span> sIssueDate;
<span class="lnr">1487 </span>                }
<span class="lnr">1488 </span>
<span class="lnr">1489 </span>                <span class="Comment">///</span><span class="Comment"> </span><span class="Identifier">&lt;</span><span class="Statement">summary</span><span class="Identifier">&gt;</span>
<span class="lnr">1490 </span>                <span class="Comment">///</span><span class="Comment"> </span>
<span class="lnr">1491 </span>                <span class="Comment">///</span><span class="Comment"> </span><span class="Identifier">&lt;/</span><span class="Statement">summary</span><span class="Identifier">&gt;</span>
<span class="lnr">1492 </span>                <span class="Comment">///</span><span class="Comment"> </span><span class="Identifier">&lt;</span><span class="Statement">param</span><span class="Identifier"> </span><span class="Type">name</span>=<span class="Constant">&quot;sFirstCol&quot;</span><span class="Identifier">&gt;</span><span class="Identifier">&lt;/</span><span class="Statement">param</span><span class="Identifier">&gt;</span>
<span class="lnr">1493 </span>                <span class="Comment">///</span><span class="Comment"> </span><span class="Identifier">&lt;</span><span class="Statement">param</span><span class="Identifier"> </span><span class="Type">name</span>=<span class="Constant">&quot;nCol&quot;</span><span class="Identifier">&gt;</span><span class="Identifier">&lt;/</span><span class="Statement">param</span><span class="Identifier">&gt;</span>
<span class="lnr">1494 </span>                <span class="Comment">///</span><span class="Comment"> </span><span class="Identifier">&lt;</span><span class="Statement">returns</span><span class="Identifier">&gt;</span><span class="Identifier">&lt;/</span><span class="Statement">returns</span><span class="Identifier">&gt;</span>
<span class="lnr">1495 </span>                <span class="Type">private</span> <span class="Type">string</span> SetNextColumn(<span class="Type">string</span> sFirstCol , <span class="Type">int</span> nCol)
<span class="lnr">1496 </span>                {
<span class="lnr">1497 </span>                        <span class="Type">string</span> res = <span class="Type">string</span>.Empty;
<span class="lnr">1498 </span>                        <span class="Type">long</span> nFirstCol = FieldName2Long(sFirstCol);
<span class="lnr">1499 </span>                        <span class="Type">long</span> nNextCol = nFirstCol + nCol;
<span class="lnr">1500 </span>
<span class="lnr">1501 </span>                        <span class="Type">string</span> sString = <span class="Type">string</span>.Empty;
<span class="lnr">1502 </span>                        <span class="Statement">do</span>
<span class="lnr">1503 </span>                        {
<span class="lnr">1504 </span>                                <span class="Type">long</span> nDenom = nNextCol % <span class="Constant">26</span>;
<span class="lnr">1505 </span>
<span class="lnr">1506 </span>                                sString = <span class="Type">string</span>.Format( <span class="Constant">&quot;{0}&quot;</span> , (<span class="Type">char</span>)(<span class="Constant">'A'</span> + nDenom - <span class="Constant">1</span>));
<span class="lnr">1507 </span>
<span class="lnr">1508 </span>                                res = sString + res;
<span class="lnr">1509 </span>
<span class="lnr">1510 </span>                                nNextCol /= <span class="Constant">26</span>;
<span class="lnr">1511 </span>
<span class="lnr">1512 </span>                        }<span class="Statement">while</span>( nNextCol &gt; <span class="Constant">0</span>);
<span class="lnr">1513 </span>
<span class="lnr">1514 </span>                        <span class="Statement">return</span> res;
<span class="lnr">1515 </span>                }
<span class="lnr">1516 </span>
<span class="lnr">1517 </span>                <span class="Comment">///</span><span class="Comment"> </span><span class="Identifier">&lt;</span><span class="Statement">summary</span><span class="Identifier">&gt;</span>
<span class="lnr">1518 </span>                <span class="Comment">///</span><span class="Comment"> </span>
<span class="lnr">1519 </span>                <span class="Comment">///</span><span class="Comment"> </span><span class="Identifier">&lt;/</span><span class="Statement">summary</span><span class="Identifier">&gt;</span>
<span class="lnr">1520 </span>                <span class="Comment">///</span><span class="Comment"> </span><span class="Identifier">&lt;</span><span class="Statement">param</span><span class="Identifier"> </span><span class="Type">name</span>=<span class="Constant">&quot;sFieldName&quot;</span><span class="Identifier">&gt;</span><span class="Identifier">&lt;/</span><span class="Statement">param</span><span class="Identifier">&gt;</span>
<span class="lnr">1521 </span>                <span class="Comment">///</span><span class="Comment"> </span><span class="Identifier">&lt;</span><span class="Statement">returns</span><span class="Identifier">&gt;</span><span class="Identifier">&lt;/</span><span class="Statement">returns</span><span class="Identifier">&gt;</span>
<span class="lnr">1522 </span>                <span class="Type">private</span> <span class="Type">long</span> FieldName2Long(<span class="Type">string</span> sFieldName)
<span class="lnr">1523 </span>                {
<span class="lnr">1524 </span>                        <span class="Type">long</span> ret = <span class="Constant">0L</span>;
<span class="lnr">1525 </span>
<span class="lnr">1526 </span>                        <span class="Statement">for</span> (<span class="Type">int</span> i = sFieldName.Length - <span class="Constant">1</span>; i &gt;= <span class="Constant">0</span>; i--)
<span class="lnr">1527 </span>                        {
<span class="lnr">1528 </span>                                ret += (sFieldName[i] - <span class="Constant">'A'</span> + <span class="Constant">1</span>) + i * <span class="Constant">26</span>;
<span class="lnr">1529 </span>                        }
<span class="lnr">1530 </span>
<span class="lnr">1531 </span>                        <span class="Statement">return</span> ret;
<span class="lnr">1532 </span>                }
<span class="lnr">1533 </span>
<span class="lnr">1534 </span>                <span class="Comment">///</span><span class="Comment"> </span><span class="Identifier">&lt;</span><span class="Statement">summary</span><span class="Identifier">&gt;</span>
<span class="lnr">1535 </span>                <span class="Comment">///</span><span class="Comment"> export data to excel file</span>
<span class="lnr">1536 </span>                <span class="Comment">///</span><span class="Comment"> </span><span class="Identifier">&lt;/</span><span class="Statement">summary</span><span class="Identifier">&gt;</span>
<span class="lnr">1537 </span>                <span class="Comment">///</span><span class="Comment"> </span><span class="Identifier">&lt;</span><span class="Statement">param</span><span class="Identifier"> </span><span class="Type">name</span>=<span class="Constant">&quot;sender&quot;</span><span class="Identifier">&gt;</span><span class="Identifier">&lt;/</span><span class="Statement">param</span><span class="Identifier">&gt;</span>
<span class="lnr">1538 </span>                <span class="Comment">///</span><span class="Comment"> </span><span class="Identifier">&lt;</span><span class="Statement">param</span><span class="Identifier"> </span><span class="Type">name</span>=<span class="Constant">&quot;e&quot;</span><span class="Identifier">&gt;</span><span class="Identifier">&lt;/</span><span class="Statement">param</span><span class="Identifier">&gt;</span>
<span class="lnr">1539 </span>                <span class="Type">private</span> <span class="Type">void</span> btnExport_Click(<span class="Type">object</span> sender, EventArgs e)
<span class="lnr">1540 </span>                {
<span class="lnr">1541 </span>                        System.Diagnostics.Process[] PROC = System.Diagnostics.Process.GetProcessesByName(<span class="Constant">&quot;EXCEL&quot;</span>);
<span class="lnr">1542 </span>
<span class="lnr">1543 </span>                        <span class="Type">int</span> iNextColumn = <span class="Constant">10</span>;
<span class="lnr">1544 </span>                        <span class="Statement">try</span>
<span class="lnr">1545 </span>                        {
<span class="lnr">1546 </span>                                <span class="Type">int</span> ExCount = BusinessLogic.DrawingExcelMatching.ExCount;
<span class="lnr">1547 </span>                                <span class="Type">int</span> iExlStartRow = BusinessLogic.DrawingExcelMatching.iExlStartRow;
<span class="lnr">1548 </span>
<span class="lnr">1549 </span>                                <span class="Comment">///</span><span class="Comment">! </span>
<span class="lnr">1550 </span>                                DrawingReporter oDrawingReporter = <span class="Statement">new</span> DrawingReporter();
<span class="lnr">1551 </span>                                oDrawingReporter.ReadDrawingExcelMatchingEntry(BusinessLogic);
<span class="lnr">1552 </span>
<span class="lnr">1553 </span>                                <span class="Type">object</span> objRange = <span class="Constant">null</span>, objFont = <span class="Constant">null</span>;
<span class="lnr">1554 </span>                                ExcelAutomation xlApp = <span class="Statement">new</span> ExcelAutomation(<span class="Constant">false</span>);
<span class="lnr">1555 </span>                                <span class="Statement">if</span> (<span class="Constant">true</span> == xlApp.Open(AppPath + <span class="Special">@</span><span class="Constant">&quot;\Setting\ISOPrintTemp.xls&quot;</span>))
<span class="lnr">1556 </span>                                {
<span class="lnr">1557 </span>                                        <span class="Type">object</span>[] parameter = <span class="Statement">new</span> <span class="Type">object</span>[<span class="Constant">1</span>];
<span class="lnr">1558 </span>                                        parameter[<span class="Constant">0</span>] = <span class="Constant">1</span>;
<span class="lnr">1559 </span>                                        <span class="Type">object</span> objWorksheet = xlApp.Worksheets.GetType().InvokeMember(<span class="Constant">&quot;item&quot;</span>, BindingFlags.GetProperty, <span class="Constant">null</span>, xlApp.Worksheets, parameter);
<span class="lnr">1560 </span>
<span class="lnr">1561 </span>                                        <span class="Comment">///</span><span class="Comment">! CLIENT NAME,PROJECT NAME 과 JOB NO.를 기입한다.</span>
<span class="lnr">1562 </span>                                        xlApp.SetCellValue(objWorksheet, <span class="Statement">new</span> <span class="Type">object</span>[] { <span class="Constant">&quot;D3&quot;</span>, Missing.Value }, <span class="Constant">&quot;'&quot;</span> + BusinessLogic.ClientName);
<span class="lnr">1563 </span>                                        xlApp.SetCellValue(objWorksheet, <span class="Statement">new</span> <span class="Type">object</span>[] { <span class="Constant">&quot;D4&quot;</span>, Missing.Value }, <span class="Constant">&quot;'&quot;</span> + BusinessLogic.ProjectDesc);
<span class="lnr">1564 </span>                                        xlApp.SetCellValue(objWorksheet, <span class="Statement">new</span> <span class="Type">object</span>[] { <span class="Constant">&quot;D5&quot;</span>, Missing.Value }, <span class="Constant">&quot;'&quot;</span> + BusinessLogic.JobNo);
<span class="lnr">1565 </span>
<span class="lnr">1566 </span>                                        <span class="Comment">///</span><span class="Comment">! copy sheets</span>
<span class="lnr">1567 </span>                                        <span class="Type">int</span> iSheetCount = dataGridView_LineData.Rows.Count / ITEM_COUNT_PER_SHEET;
<span class="lnr">1568 </span>                                        <span class="Type">int</span> iRemain = (dataGridView_LineData.Rows.Count % ITEM_COUNT_PER_SHEET);
<span class="lnr">1569 </span>                                        <span class="Statement">if</span> (iRemain &gt; <span class="Constant">0</span>) ++iSheetCount;
<span class="lnr">1570 </span>                                        <span class="Statement">for</span> (<span class="Type">int</span> i = <span class="Constant">0</span>; i &lt; iSheetCount - <span class="Constant">1</span>; ++i)
<span class="lnr">1571 </span>                                        {
<span class="lnr">1572 </span>                                                parameter[<span class="Constant">0</span>] = objWorksheet;
<span class="lnr">1573 </span>                                                xlApp.InvokeMethod(objWorksheet, <span class="Constant">&quot;Copy&quot;</span>, parameter);
<span class="lnr">1574 </span>                                                {
<span class="lnr">1575 </span>                                                        objWorksheet = xlApp.GetActiveSheet();
<span class="lnr">1576 </span>                                                        parameter[<span class="Constant">0</span>] = <span class="Constant">&quot;Sheet &quot;</span> + (i + <span class="Constant">2</span>);
<span class="lnr">1577 </span>                                                        xlApp.SetProperty(objWorksheet, <span class="Constant">&quot;Name&quot;</span>, parameter);
<span class="lnr">1578 </span>                                                }
<span class="lnr">1579 </span>                                        }
<span class="lnr">1580 </span>
<span class="lnr">1581 </span>                                        <span class="Statement">for</span> (<span class="Type">int</span> iSheet = <span class="Constant">1</span>; iSheet &lt;= iSheetCount; ++iSheet)
<span class="lnr">1582 </span>                                        {
<span class="lnr">1583 </span>                                                objWorksheet = xlApp.SetActiveSheet(iSheet);
<span class="lnr">1584 </span>                                                <span class="Type">int</span> iRow = iExlStartRow, iNo = <span class="Constant">1</span>;
<span class="lnr">1585 </span>                                                <span class="Statement">for</span> (<span class="Type">int</span> k = <span class="Constant">0</span>; k &lt; ITEM_COUNT_PER_SHEET; ++k)
<span class="lnr">1586 </span>                                                {
<span class="lnr">1587 </span>                                                        <span class="Type">int</span> i = (iSheet - <span class="Constant">1</span>) * ITEM_COUNT_PER_SHEET + k + <span class="Constant">1</span>;
<span class="lnr">1588 </span>                                                        <span class="Statement">if</span> (i &gt; dataGridView_LineData.Rows.Count) <span class="Statement">break</span>;
<span class="lnr">1589 </span>
<span class="lnr">1590 </span>                                                        <span class="Type">int</span> row = iExlStartRow + k;
<span class="lnr">1591 </span>                                                        <span class="Statement">if</span> (k &gt;= ITEM_HALF_COUNT_PER_SHEET)
<span class="lnr">1592 </span>                                                        {
<span class="lnr">1593 </span>                                                                iNo = iNextColumn + <span class="Constant">1</span>;
<span class="lnr">1594 </span>                                                                row = row - ITEM_HALF_COUNT_PER_SHEET;
<span class="lnr">1595 </span>                                                        }
<span class="lnr">1596 </span>
<span class="lnr">1597 </span>                                                        <span class="Type">object</span> oValue = dataGridView_LineData.Rows[i - <span class="Constant">1</span>].Cells[<span class="Constant">0</span>].Value;
<span class="lnr">1598 </span>                                                        <span class="Type">bool</span> bCancellation = ((<span class="Type">string</span>.Empty != oValue.ToString()) &amp;&amp; (<span class="Constant">true</span> == (<span class="Type">bool</span>)oValue));
<span class="lnr">1599 </span>                                                        <span class="Type">string</span> sCellNo = xlApp.MakeCellNo(row, iNo);
<span class="lnr">1600 </span>                                                        <span class="Statement">if</span> (bCancellation)
<span class="lnr">1601 </span>                                                        {
<span class="lnr">1602 </span>                                                                objRange = xlApp.GetProperty(objWorksheet, <span class="Constant">&quot;Range&quot;</span>, <span class="Statement">new</span> <span class="Type">object</span>[] { sCellNo, sCellNo });
<span class="lnr">1603 </span>                                                                objFont = xlApp.GetProperty(objRange, <span class="Constant">&quot;Font&quot;</span>, <span class="Constant">null</span>);
<span class="lnr">1604 </span>                                                                xlApp.SetCellTextColor(objWorksheet, objRange, <span class="Constant">3</span>);
<span class="lnr">1605 </span>                                                                xlApp.SetProperty(objFont, <span class="Constant">&quot;Strikethrough&quot;</span>, <span class="Statement">new</span> <span class="Type">object</span>[] {<span class="Constant">true</span>});
<span class="lnr">1606 </span>                                                        }
<span class="lnr">1607 </span>                                                        xlApp.SetCellValue(objWorksheet , <span class="Statement">new</span> <span class="Type">object</span>[] { sCellNo, Missing.Value } , <span class="Type">string</span>.Format(<span class="Constant">&quot;{0}&quot;</span> , i));
<span class="lnr">1608 </span>
<span class="lnr">1609 </span>                                                        <span class="Type">string</span> sKey = dataGridView_LineData.Rows[i - <span class="Constant">1</span>].Cells[<span class="Constant">1</span>].Value.ToString();
<span class="lnr">1610 </span>                                                        <span class="Statement">foreach</span> (ExlStruct oExlStruct <span class="Statement">in</span> oDrawingReporter.ExlResultEntry)
<span class="lnr">1611 </span>                                                        {
<span class="lnr">1612 </span>                                                                System.Text.RegularExpressions.Regex oRegex = <span class="Statement">new</span> System.Text.RegularExpressions.Regex(<span class="Constant">&quot;REV [0-9]+ DATE&quot;</span>);
<span class="lnr">1613 </span>                                                                <span class="Statement">if</span> (<span class="Constant">true</span> == oRegex.IsMatch(oExlStruct.ExlDesc))
<span class="lnr">1614 </span>                                                                {
<span class="lnr">1615 </span>                                                                        <span class="Type">int</span> iRevNo = <span class="Constant">0</span>;
<span class="lnr">1616 </span>                                                                        <span class="Type">string</span>[] oTokens = oExlStruct.ExlDesc.Split(<span class="Constant">&quot; &quot;</span>.ToCharArray());
<span class="lnr">1617 </span>                                                                        Int32.TryParse(oTokens[<span class="Constant">1</span>], <span class="Statement">out</span> iRevNo);
<span class="lnr">1618 </span>                                                                        <span class="Type">string</span> sIssueDate = GetRevIssueDateAtIndex(sKey , iRevNo);
<span class="lnr">1619 </span>
<span class="lnr">1620 </span>                                                                        <span class="Type">string</span> sFirst = oExlStruct.ExlColumn;
<span class="lnr">1621 </span>                                                                        <span class="Type">string</span> sLast = <span class="Type">string</span>.Format(<span class="Constant">&quot;{0}&quot;</span>, row);
<span class="lnr">1622 </span>                                                                        <span class="Statement">if</span> (k &gt;= ITEM_HALF_COUNT_PER_SHEET)
<span class="lnr">1623 </span>                                                                        {
<span class="lnr">1624 </span>                                                                                sFirst = SetNextColumn(sFirst , iNextColumn);
<span class="lnr">1625 </span>                                                                        }
<span class="lnr">1626 </span>                                                                        sCellNo = sFirst + sLast;
<span class="lnr">1627 </span>
<span class="lnr">1628 </span>                                                                        <span class="Statement">if</span> (bCancellation)
<span class="lnr">1629 </span>                                                                        {
<span class="lnr">1630 </span>                                                                                objRange = xlApp.GetProperty(objWorksheet, <span class="Constant">&quot;Range&quot;</span>, <span class="Statement">new</span> <span class="Type">object</span>[] { sCellNo, sCellNo });
<span class="lnr">1631 </span>                                                                                objFont = xlApp.GetProperty(objRange, <span class="Constant">&quot;Font&quot;</span>, <span class="Constant">null</span>);
<span class="lnr">1632 </span>                                                                                xlApp.SetCellTextColor(objWorksheet, objRange, <span class="Constant">3</span>);
<span class="lnr">1633 </span>                                                                                xlApp.SetProperty(objFont, <span class="Constant">&quot;Strikethrough&quot;</span>, <span class="Statement">new</span> <span class="Type">object</span>[] {<span class="Constant">true</span>});
<span class="lnr">1634 </span>                                                                        }
<span class="lnr">1635 </span>                                                                        xlApp.SetCellValue(objWorksheet , <span class="Statement">new</span> <span class="Type">object</span>[] { sCellNo, Missing.Value } , sIssueDate);
<span class="lnr">1636 </span>                                                                }
<span class="lnr">1637 </span>                                                                <span class="Statement">else</span> <span class="Statement">if</span> (<span class="Constant">&quot;LAST REV NO&quot;</span> == oExlStruct.ExlDesc)
<span class="lnr">1638 </span>                                                                {
<span class="lnr">1639 </span>                                                                        <span class="Type">string</span> sIssueDate = GetRevIssueDateAtIndex(sKey, -<span class="Constant">1</span>);
<span class="lnr">1640 </span>                                                                        <span class="Type">string</span> sFirst = oExlStruct.ExlColumn;
<span class="lnr">1641 </span>                                                                        <span class="Type">string</span> sLast = <span class="Type">string</span>.Format(<span class="Constant">&quot;{0}&quot;</span>, row);
<span class="lnr">1642 </span>                                                                        <span class="Statement">if</span> (k &gt;= ITEM_HALF_COUNT_PER_SHEET)
<span class="lnr">1643 </span>                                                                        {
<span class="lnr">1644 </span>                                                                                sFirst = SetNextColumn(sFirst, iNextColumn);
<span class="lnr">1645 </span>                                                                        }
<span class="lnr">1646 </span>                                                                        sCellNo = sFirst + sLast;
<span class="lnr">1647 </span>
<span class="lnr">1648 </span>                                                                        <span class="Statement">if</span> (bCancellation)
<span class="lnr">1649 </span>                                                                        {
<span class="lnr">1650 </span>                                                                                objRange = xlApp.GetProperty(objWorksheet, <span class="Constant">&quot;Range&quot;</span>, <span class="Statement">new</span> <span class="Type">object</span>[] { sCellNo, sCellNo });
<span class="lnr">1651 </span>                                                                                objFont = xlApp.GetProperty(objRange, <span class="Constant">&quot;Font&quot;</span>, <span class="Constant">null</span>);
<span class="lnr">1652 </span>                                                                                xlApp.SetCellTextColor(objWorksheet, objRange, <span class="Constant">3</span>);
<span class="lnr">1653 </span>                                                                                xlApp.SetProperty(objFont, <span class="Constant">&quot;Strikethrough&quot;</span>, <span class="Statement">new</span> <span class="Type">object</span>[] { <span class="Constant">true</span> });
<span class="lnr">1654 </span>                                                                        }
<span class="lnr">1655 </span>                                                                        xlApp.SetCellValue(objWorksheet, <span class="Statement">new</span> <span class="Type">object</span>[] { sCellNo, Missing.Value }, sIssueDate);
<span class="lnr">1656 </span>                                                                }
<span class="lnr">1657 </span>                                                                <span class="Statement">else</span>
<span class="lnr">1658 </span>                                                                {
<span class="lnr">1659 </span>                                                                        <span class="Type">string</span> sCommand = <span class="Type">string</span>.Format(<span class="Constant">&quot;SELECT {0} FROM T_ISSUED_LINE_DATA WHERE C_KEY='{1}'&quot;</span>,oExlStruct.ExlDesc , sKey);
<span class="lnr">1660 </span>                                                                        GetDataSetFrom(sCommand, <span class="Constant">false</span>);
<span class="lnr">1661 </span>                                                                        <span class="Statement">if</span> (m_table.Rows.Count &gt; <span class="Constant">0</span>)
<span class="lnr">1662 </span>                                                                        {
<span class="lnr">1663 </span>                                                                                <span class="Type">string</span> sValue = m_table.Rows[<span class="Constant">0</span>].ItemArray[<span class="Constant">0</span>].ToString();
<span class="lnr">1664 </span>                                                                                <span class="Statement">if</span> (<span class="Constant">&quot;LINE STATUS&quot;</span> == oExlStruct.ExlDesc)
<span class="lnr">1665 </span>                                                                                {
<span class="lnr">1666 </span>                                                                                        <span class="Statement">if</span> (<span class="Constant">&quot;LIVE&quot;</span> == sValue) <span class="Statement">continue</span>;
<span class="lnr">1667 </span>                                                                                        <span class="Type">string</span> sFirst = oExlStruct.ExlColumn;
<span class="lnr">1668 </span>                                                                                        <span class="Type">string</span> sLast = <span class="Type">string</span>.Format(<span class="Constant">&quot;{0}&quot;</span>, row);
<span class="lnr">1669 </span>                                                                                        <span class="Statement">if</span> (k &gt;= ITEM_HALF_COUNT_PER_SHEET)
<span class="lnr">1670 </span>                                                                                        {
<span class="lnr">1671 </span>                                                                                                sFirst = SetNextColumn(sFirst, iNextColumn);
<span class="lnr">1672 </span>                                                                                        }
<span class="lnr">1673 </span>                                                                                        sCellNo = sFirst + sLast;
<span class="lnr">1674 </span>
<span class="lnr">1675 </span>                                                                                        <span class="Statement">if</span> (bCancellation)
<span class="lnr">1676 </span>                                                                                        {
<span class="lnr">1677 </span>                                                                                                objRange = xlApp.GetProperty(objWorksheet, <span class="Constant">&quot;Range&quot;</span>, <span class="Statement">new</span> <span class="Type">object</span>[] { sCellNo, sCellNo });
<span class="lnr">1678 </span>                                                                                                objFont = xlApp.GetProperty(objRange, <span class="Constant">&quot;Font&quot;</span>, <span class="Constant">null</span>);
<span class="lnr">1679 </span>                                                                                                xlApp.SetCellTextColor(objWorksheet, objRange, <span class="Constant">3</span>);
<span class="lnr">1680 </span>                                                                                                xlApp.SetProperty(objFont, <span class="Constant">&quot;Strikethrough&quot;</span>, <span class="Statement">new</span> <span class="Type">object</span>[] { <span class="Constant">true</span> });
<span class="lnr">1681 </span>                                                                                        }
<span class="lnr">1682 </span>                                                                                        xlApp.SetCellValue(objWorksheet, <span class="Statement">new</span> <span class="Type">object</span>[] { sCellNo, Missing.Value }, sValue);
<span class="lnr">1683 </span>                                                                                }
<span class="lnr">1684 </span>                                                                                <span class="Statement">else</span>
<span class="lnr">1685 </span>                                                                                {
<span class="lnr">1686 </span>                                                                                        <span class="Type">string</span> sFirst = oExlStruct.ExlColumn;
<span class="lnr">1687 </span>                                                                                        <span class="Type">string</span> sLast = <span class="Type">string</span>.Format(<span class="Constant">&quot;{0}&quot;</span>, row);
<span class="lnr">1688 </span>                                                                                        <span class="Statement">if</span> (k &gt;= ITEM_HALF_COUNT_PER_SHEET)
<span class="lnr">1689 </span>                                                                                        {
<span class="lnr">1690 </span>                                                                                                sFirst = SetNextColumn(sFirst, iNextColumn);
<span class="lnr">1691 </span>                                                                                        }
<span class="lnr">1692 </span>                                                                                        sCellNo = sFirst + sLast;
<span class="lnr">1693 </span>
<span class="lnr">1694 </span>                                                                                        <span class="Statement">if</span> (bCancellation)
<span class="lnr">1695 </span>                                                                                        {
<span class="lnr">1696 </span>                                                                                                objRange = xlApp.GetProperty(objWorksheet, <span class="Constant">&quot;Range&quot;</span>, <span class="Statement">new</span> <span class="Type">object</span>[] { sCellNo, sCellNo });
<span class="lnr">1697 </span>                                                                                                objFont = xlApp.GetProperty(objRange, <span class="Constant">&quot;Font&quot;</span>, <span class="Constant">null</span>);
<span class="lnr">1698 </span>                                                                                                xlApp.SetCellTextColor(objWorksheet, objRange, <span class="Constant">3</span>);
<span class="lnr">1699 </span>                                                                                                xlApp.SetProperty(objFont, <span class="Constant">&quot;Strikethrough&quot;</span>, <span class="Statement">new</span> <span class="Type">object</span>[] { <span class="Constant">true</span> });
<span class="lnr">1700 </span>                                                                                        }
<span class="lnr">1701 </span>                                                                                        xlApp.SetCellValue(objWorksheet, <span class="Statement">new</span> <span class="Type">object</span>[] { sCellNo, Missing.Value }, sValue);
<span class="lnr">1702 </span>                                                                                }
<span class="lnr">1703 </span>                                                                        }
<span class="lnr">1704 </span>                                                                }
<span class="lnr">1705 </span>                                                        }
<span class="lnr">1706 </span>                                                }
<span class="lnr">1707 </span>                                        }
<span class="lnr">1708 </span>
<span class="lnr">1709 </span>                                        xlApp.SaveAs(BusinessLogic.DrawingExcelMatching.ExlPath);
<span class="lnr">1710 </span>                                        MessageBox.Show(<span class="Constant">&quot;Export is complete&quot;</span>);
<span class="lnr">1711 </span>                                }
<span class="lnr">1712 </span>                                <span class="Statement">else</span>
<span class="lnr">1713 </span>                                {
<span class="lnr">1714 </span>                                        MessageBox.Show(<span class="Constant">&quot;Can't find template excel file&quot;</span>);
<span class="lnr">1715 </span>                                }
<span class="lnr">1716 </span>                        }
<span class="lnr">1717 </span>                        <span class="Statement">catch</span>(Exception ex)
<span class="lnr">1718 </span>                        {
<span class="lnr">1719 </span>                                Console.WriteLine(<span class="Constant">&quot;Error Message {0}&quot;</span> , ex.Message);
<span class="lnr">1720 </span>                        }
<span class="lnr">1721 </span>
<span class="lnr">1722 </span>                        <span class="Comment">///</span><span class="Comment">! exit excel process</span>
<span class="lnr">1723 </span>                        PROC = System.Diagnostics.Process.GetProcessesByName(<span class="Constant">&quot;EXCEL&quot;</span>);
<span class="lnr">1724 </span>                        <span class="Statement">foreach</span> (System.Diagnostics.Process PK <span class="Statement">in</span> PROC)
<span class="lnr">1725 </span>                        {
<span class="lnr">1726 </span>                                <span class="Statement">if</span> (PK.MainWindowTitle.Length == <span class="Constant">0</span>)
<span class="lnr">1727 </span>                                        PK.Kill();
<span class="lnr">1728 </span>                        }
<span class="lnr">1729 </span>                }
<span class="lnr">1730 </span>
<DIV style="BORDER-BOTTOM: #ff0000 1px solid; BORDER-LEFT: #ff0000 1px solid; PADDING-LEFT: 8px; PADDING-RIGHT: 8px; DISPLAY: block; BACKGROUND: #000040; BORDER-TOP: #ff0000 1px solid; BORDER-RIGHT: #ff0000 1px solid;">
<span class="lnr">1731 </span>                <span class="Comment">///</span><span class="Comment"> </span><span class="Identifier">&lt;</span><span class="Statement">summary</span><span class="Identifier">&gt;</span>
<span class="lnr">1732 </span>                <span class="Comment">///</span><span class="Comment"> </span>
<span class="lnr">1733 </span>                <span class="Comment">///</span><span class="Comment"> </span><span class="Identifier">&lt;/</span><span class="Statement">summary</span><span class="Identifier">&gt;</span>
<span class="lnr">1734 </span>                <span class="Comment">///</span><span class="Comment"> </span><span class="Identifier">&lt;</span><span class="Statement">param</span><span class="Identifier"> </span><span class="Type">name</span>=<span class="Constant">&quot;sender&quot;</span><span class="Identifier">&gt;</span><span class="Identifier">&lt;/</span><span class="Statement">param</span><span class="Identifier">&gt;</span>
<span class="lnr">1735 </span>                <span class="Comment">///</span><span class="Comment"> </span><span class="Identifier">&lt;</span><span class="Statement">param</span><span class="Identifier"> </span><span class="Type">name</span>=<span class="Constant">&quot;e&quot;</span><span class="Identifier">&gt;</span><span class="Identifier">&lt;/</span><span class="Statement">param</span><span class="Identifier">&gt;</span>
<span class="lnr">1736 </span>                <span class="Type">private</span> <span class="Type">void</span> dataGridView_LineData_CurrentCellDirtyStateChanged(<span class="Type">object</span> sender, EventArgs e)
<span class="lnr">1737 </span>                {
<span class="lnr">1738 </span>                        <span class="Statement">if</span> (dataGridView_LineData.IsCurrentCellDirty)
<span class="lnr">1739 </span>                        {
<span class="lnr">1740 </span>                                dataGridView_LineData.CommitEdit(DataGridViewDataErrorContexts.Commit);
<span class="lnr">1741 </span>                        }
<span class="lnr">1742 </span>                }
<span class="lnr">1743 </span>
<span class="lnr">1744 </span>                <span class="Comment">///</span><span class="Comment"> </span><span class="Identifier">&lt;</span><span class="Statement">summary</span><span class="Identifier">&gt;</span>
<span class="lnr">1745 </span>                <span class="Comment">///</span><span class="Comment"> </span>
<span class="lnr">1746 </span>                <span class="Comment">///</span><span class="Comment"> </span><span class="Identifier">&lt;/</span><span class="Statement">summary</span><span class="Identifier">&gt;</span>
<span class="lnr">1747 </span>                <span class="Comment">///</span><span class="Comment"> </span><span class="Identifier">&lt;</span><span class="Statement">param</span><span class="Identifier"> </span><span class="Type">name</span>=<span class="Constant">&quot;sender&quot;</span><span class="Identifier">&gt;</span><span class="Identifier">&lt;/</span><span class="Statement">param</span><span class="Identifier">&gt;</span>
<span class="lnr">1748 </span>                <span class="Comment">///</span><span class="Comment"> </span><span class="Identifier">&lt;</span><span class="Statement">param</span><span class="Identifier"> </span><span class="Type">name</span>=<span class="Constant">&quot;e&quot;</span><span class="Identifier">&gt;</span><span class="Identifier">&lt;/</span><span class="Statement">param</span><span class="Identifier">&gt;</span>
<span class="lnr">1749 </span>                <span class="Type">private</span> <span class="Type">void</span> dataGridView_LineData_CellValueChanged(<span class="Type">object</span> sender, DataGridViewCellEventArgs e)
<span class="lnr">1750 </span>                {
<span class="lnr">1751 </span>                        <span class="Statement">if</span> (<span class="Constant">0</span> == e.ColumnIndex)
<span class="lnr">1752 </span>                        {
<span class="lnr">1753 </span>                                <span class="Type">bool</span> bValue = ((<span class="Type">bool</span>)dataGridView_LineData[e.ColumnIndex, e.RowIndex].Value);
<span class="lnr">1754 </span>                                <span class="Statement">if</span> (<span class="Constant">true</span> == bValue)
<span class="lnr">1755 </span>                                {
<span class="lnr">1756 </span>                                        Font oFont = <span class="Statement">new</span> Font(dataGridView_LineData.Font, FontStyle.Strikeout);
<span class="lnr">1757 </span>                                        <span class="Statement">for</span> (<span class="Type">int</span> j = <span class="Constant">1</span>; j &lt; dataGridView_LineData.Columns.Count; ++j)
<span class="lnr">1758 </span>                                        {
<span class="lnr">1759 </span>                                                dataGridView_LineData.Rows[e.RowIndex].Cells[j].Style.ForeColor = Color.FromArgb(<span class="Constant">255</span>, <span class="Constant">0</span>, <span class="Constant">0</span>);
<span class="lnr">1760 </span>                                                dataGridView_LineData.Rows[e.RowIndex].Cells[j].Style.Font = oFont;
<span class="lnr">1761 </span>                                        }
<span class="lnr">1762 </span>                                }
<span class="lnr">1763 </span>                                <span class="Statement">else</span>
<span class="lnr">1764 </span>                                {
<span class="lnr">1765 </span>                                        <span class="Statement">for</span> (<span class="Type">int</span> j = <span class="Constant">1</span>; j &lt; dataGridView_LineData.Columns.Count; ++j)
<span class="lnr">1766 </span>                                        {
<span class="lnr">1767 </span>                                                dataGridView_LineData.Rows[e.RowIndex].Cells[j].Style.ForeColor = Color.FromArgb(<span class="Constant">0</span>, <span class="Constant">0</span>, <span class="Constant">0</span>);
<span class="lnr">1768 </span>                                                dataGridView_LineData.Rows[e.RowIndex].Cells[j].Style.Font = <span class="Constant">null</span>;
<span class="lnr">1769 </span>                                        }
<span class="lnr">1770 </span>                                }
<span class="lnr">1771 </span>                                dataGridView_LineData.Invalidate();
<span class="lnr">1772 </span>
<span class="lnr">1773 </span>                                <span class="Comment">///</span><span class="Comment">! </span>
<span class="lnr">1774 </span>                                <span class="Type">string</span> sConnection = <span class="Constant">&quot;Provider=Microsoft.Jet.OLEDB.4.0;Data Source=&quot;</span> + BusinessLogic.DatabasePath;
<span class="lnr">1775 </span>                                <span class="Type">string</span> sCondition = <span class="Type">string</span>.Empty;
<span class="lnr">1776 </span>                                <span class="Type">string</span> sKey = dataGridView_LineData[<span class="Constant">1</span>, e.RowIndex].Value.ToString();
<span class="lnr">1777 </span>
<span class="lnr">1778 </span>                                <span class="Statement">try</span>
<span class="lnr">1779 </span>                                {
<span class="lnr">1780 </span>                                        m_connection.Open(sConnection, <span class="Constant">null</span>, <span class="Constant">null</span>, <span class="Constant">0</span>);
<span class="lnr">1781 </span>                                        <span class="Type">string</span> sCommand = <span class="Type">string</span>.Format(<span class="Constant">&quot;UPDATE T_ISSUED_LINE_DATA SET C_CANCELLATION={0} WHERE C_KEY='{1}'&quot;</span>, ((<span class="Constant">true</span> == bValue) ? <span class="Constant">&quot;1&quot;</span> : <span class="Constant">&quot;0&quot;</span>), sKey);
<span class="lnr">1782 </span>                                        <span class="Statement">try</span>
<span class="lnr">1783 </span>                                        {
<span class="lnr">1784 </span>                                                <span class="Type">object</span> obj;
<span class="lnr">1785 </span>                                                m_connection.Execute(sCommand, <span class="Statement">out</span> obj, <span class="Constant">0</span>);
<span class="lnr">1786 </span>                                        }
<span class="lnr">1787 </span>                                        <span class="Statement">catch</span> (OleDbException ex)
<span class="lnr">1788 </span>                                        {
<span class="lnr">1789 </span>                                                MessageBox.Show(ex.Errors.ToString());
<span class="lnr">1790 </span>                                        }
<span class="lnr">1791 </span>                                }
<span class="lnr">1792 </span>                                <span class="Statement">catch</span>
<span class="lnr">1793 </span>                                {
<span class="lnr">1794 </span>                                }
<span class="lnr">1795 </span>                                m_connection.Close();
<span class="lnr">1796 </span>                        }
<span class="lnr">1797 </span>                }
</DIV>
<span class="lnr">1798 </span>
<span class="lnr">1799 </span>                <span class="Comment">///</span><span class="Comment"> </span><span class="Identifier">&lt;</span><span class="Statement">summary</span><span class="Identifier">&gt;</span>
<span class="lnr">1800 </span>                <span class="Comment">///</span><span class="Comment"> </span>
<span class="lnr">1801 </span>                <span class="Comment">///</span><span class="Comment"> </span><span class="Identifier">&lt;/</span><span class="Statement">summary</span><span class="Identifier">&gt;</span>
<span class="lnr">1802 </span>                <span class="Comment">///</span><span class="Comment"> </span><span class="Identifier">&lt;</span><span class="Statement">param</span><span class="Identifier"> </span><span class="Type">name</span>=<span class="Constant">&quot;sender&quot;</span><span class="Identifier">&gt;</span><span class="Identifier">&lt;/</span><span class="Statement">param</span><span class="Identifier">&gt;</span>
<span class="lnr">1803 </span>                <span class="Comment">///</span><span class="Comment"> </span><span class="Identifier">&lt;</span><span class="Statement">param</span><span class="Identifier"> </span><span class="Type">name</span>=<span class="Constant">&quot;e&quot;</span><span class="Identifier">&gt;</span><span class="Identifier">&lt;/</span><span class="Statement">param</span><span class="Identifier">&gt;</span>
<span class="lnr">1804 </span>                <span class="Type">private</span> <span class="Type">void</span> IssueManager_Shown(<span class="Type">object</span> sender, EventArgs e)
<span class="lnr">1805 </span>                {
<span class="lnr">1806 </span>                        BusinessLogic.ProjectDesc =
<span class="lnr">1807 </span>                                m_oIni.GetIniValue(<span class="Constant">&quot;General&quot;</span>, <span class="Constant">&quot;Project No&quot;</span>, BusinessLogic.IniFilePath);
<span class="lnr">1808 </span>
<span class="lnr">1809 </span>                        BusinessLogic.JobNo =
<span class="lnr">1810 </span>                                m_oIni.GetIniValue(<span class="Constant">&quot;General&quot;</span>, <span class="Constant">&quot;Comment&quot;</span>, BusinessLogic.IniFilePath);
<span class="lnr">1811 </span>
<span class="lnr">1812 </span>                        BusinessLogic.ClientName =
<span class="lnr">1813 </span>                                m_oIni.GetIniValue(<span class="Constant">&quot;General&quot;</span>, <span class="Constant">&quot;Client Name&quot;</span>, BusinessLogic.IniFilePath);
<span class="lnr">1814 </span>
<span class="lnr">1815 </span>                        BusinessLogic.DrawingExcelMatching.ExlPath =
<span class="lnr">1816 </span>                                m_oIni.GetIniValue(<span class="Constant">&quot;Drawing Excel Matching&quot;</span>, <span class="Constant">&quot;ExlPath&quot;</span>, BusinessLogic.IniFilePath);
<span class="lnr">1817 </span>
<span class="lnr">1818 </span>                        BusinessLogic.DrawingExcelMatching.ExCount =
<span class="lnr">1819 </span>                                Convert.ToInt32(m_oIni.GetIniValue(<span class="Constant">&quot;Drawing Excel Matching&quot;</span>, <span class="Constant">&quot;Count&quot;</span>, BusinessLogic.IniFilePath));
<span class="lnr">1820 </span>
<span class="lnr">1821 </span>                        BusinessLogic.DrawingExcelMatching.iExlStartRow =
<span class="lnr">1822 </span>                                Convert.ToInt32(m_oIni.GetIniValue(<span class="Constant">&quot;Drawing Excel Matching&quot;</span>, <span class="Constant">&quot;Row&quot;</span>, BusinessLogic.IniFilePath));
<span class="lnr">1823 </span>                }
<span class="lnr">1824 </span>        }
<span class="lnr">1825 </span>}
</pre>
</body>
</html>
